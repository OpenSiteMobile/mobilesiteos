if(console&&console.info){console.info("msos/base -> start.");}var msos={default_locale:(document.getElementsByTagName("html")[0].getAttribute("lang")||"en"),default_translate:"fr",default_country:{en:"US",fr:"FR",de:"DE"},default_keyboard_locales:["en","fr","de","es"],base_site_url:"//"+document.domain,base_script_url:"",base_config_url:"",base_images_url:"",body:null,head:null,html:null,docl:null,ajax_loading_kbps:{},deferred_css:[],deferred_scripts:[],dom:{},form_inputs:null,form_validate:null,html_inputs:["text","file","password","textarea","radio","checkbox","select"],html5_attributes:["autocomplete","autofocus","list","placeholder","max","min","maxlength","multiple","pattern","required","step"],html5_inputs:["search","tel","url","email","datetime","date","month","week","time","datetime-local","number","range","color"],i18n_order:[],i18n_queue:0,log_methods:["error","warn","info","debug","time","timeEnd","log","assert","dir","clear","profile","profileEnd","trace"],onload_func_pre:[],onload_func_start:[],onload_functions:[],onload_func_done:[],onload_func_post:[],ondisplay_size_change:[],onorientationchange_functions:[],onresize_functions:[],pending_file_loads:[],record_times:{},registered_files:{js:{},css:{},ico:{},ajax:{}},registered_folders:{msos:"",jquery:"",apps:""},registered_modules:{msos:false},registered_templates:{},registered_tools:{},require_attempts:0,require_deferred:0,require_queue:0};msos.config={console:false,clear_storage:false,debug:false,debug_css:false,debug_output:false,debug_script:false,debug_disable:false,mobile:false,verbose:false,visualevent:false,run_ads:false,run_size:false,run_analytics:false,run_onerror:false,run_overflowscroll:false,run_social:false,run_translate:false,run_amazon_prev:false,browser:{ok:false,advanced:false,current:false,direction:"",editable:false,mobile:false,touch:false,nativeoverflow:false,fastclick:false,scalable:false},cache:true,color:{bk:"black",wh:"white",dg:"darkgrey",lg:"lightgrey",sl:"salmon",lb:"lightblue",rd:"red",be:"beige"},connection:{type:0,bandwidth:10,metered:false},storage:{site_pref:{name:"msos_site_pref",value:"",set:false},site_i18n:{name:"msos_site_i18n",value:"",set:false},site_cltl:{name:"msos_site_cltl",value:"",set:false},site_bdwd:{name:"msos_site_bdwd",value:"",set:false},site_ajax:{name:"msos_site_ajax",value:"",set:false},site_tabs:{name:"msos_site_tab_"},site_sdmn:{name:"msos_site_sdm_"},site_popu:{name:"msos_site_pop_"}},debugging:["console","debug","debug_script","debug_css","debug_output","mobile","verbose","visualevent","run_ads","run_size","run_analytics","run_onerror","run_overflowscroll","run_social","run_translate","run_amazon_prev","use_date","use_color","use_number","use_range","clear_storage"],doctype:window.document.getElementsByTagName("html")[0].getAttribute("xmlns")?"xhtml5":"html5",file:{"file":(typeof window.File==="object"?true:false),"reader":(typeof window.FileReader==="function"?true:false),"list":(typeof window.FileList==="object"?true:false),"blob":(typeof window.Blob==="object"?true:false)},force_shim:{inputs:{date:true,color:true,number:true,range:true,time:false,month:false,week:false},media:{video:false,audio:false}},google:{no_translate:{},hide_tooltip:{}},hellojs_redirect:"/mobilesiteos/hello/redirect.html",i18n:{select_trans_msos:{},select_kbrds_msos:{}},intl:{select_culture:{},select_calendar:{}},locale:(navigator.language||navigator.userLanguage||msos.default_locale).replace("-","_").toLowerCase(),culture:(navigator.language||navigator.userLanguage||msos.default_locale).replace("-","_").toLowerCase(),calendar:"standard",json:(typeof JSON==="object"&&typeof JSON.stringify==="function"&&typeof JSON.parse==="function"?true:false),jquery_ui_theme:"mobilesiteos",jquery_ui_avail:{base:"Base (generic)",lightness:"UI-Lightness",mobilesiteos:"MobileSiteOS"},keyboard:"",keyboard_locales:[].concat(msos.default_keyboard_locales),gesture:(function(){var el=document.createElement("div");el.setAttribute("ongesturestart","return;");return(typeof el.ongesturestart==="function"?true:false);}()),onerror_uri:"http://"+window.location.hostname+"/ngm/onerror.html",orientation:(typeof window.orientation==="number"?true:false),orientation_change:("onorientationchange" in window?true:false),overflow_scrolling:{webkitoverflowscrolling:("WebkitOverflowScrolling" in document.documentElement.style?true:false),msoverflowstyle:("msOverflowStyle" in document.documentElement.style?true:false)},page_uri:window.location.href,pixel_ratio:window.devicePixelRatio||1,popups_blocked:false,query:{},script_onerror:(function(){var spt=document.createElement("script");spt.type="text/javascript";spt.setAttribute("onerror","return;");if(typeof spt.onerror==="function"){return true;}return("onerror" in spt?true:false);}()),script_preload:{available:false,async:false,defer:false,explicit:false,ordered:false,xhr_cache:false},scrolltop:(window.pageXOffset!==undefined||document.documentElement.scrollTop!==undefined?true:false),size:"",size_folder:"css",size_array:[],size_wide:{"desktop":1080,"large":960,"medium":760,"small":640,"tablet":480,"phone":320},social:{},touch:{ontouchstart:("ontouchstart" in window?true:false),ontouchend:("ontouchend" in document?true:false),ontouchmove:("ontouchmove" in document?true:false),object:(typeof window.Touch==="object"?true:false),event:(window.TouchEvent!==undefined?true:false),create:("createTouch" in document?true:false),doc_touch:("DocumentTouch" in window&&document instanceof DocumentTouch?true:false)},view_orientation:{layout:"",direction:"",method:"",numeric:0},view_port:{height:0,width:0,delta_width:0,delta_heigth:0}};(function(_global){var tag2attr={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href",embed:"src",object:"data"},key=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],aliases={"anchor":"fragment"},parser={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},isint=/^[0-9]+$/;function parseUri(url,strictMode){var str=decodeURI(url),res=parser[strictMode||false?"strict":"loose"].exec(str),uri={attr:{},param:{},seg:{}},i=14;while(i--){uri.attr[key[i]]=res[i]||"";}uri.param["query"]=parseString(uri.attr["query"]);uri.param["fragment"]=parseString(uri.attr["fragment"]);uri.seg["path"]=uri.attr.path.replace(/^\/+|\/+$/g,"").split("/");uri.seg["fragment"]=uri.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");uri.attr["base"]=uri.attr.host?(uri.attr.protocol?uri.attr.protocol+"://"+uri.attr.host:uri.attr.host)+(uri.attr.port?":"+uri.attr.port:""):"";return uri;}function getAttrName(elm){var tn=elm.tagName;if(typeof tn!=="undefined"){return tag2attr[tn.toLowerCase()];}return tn;}function promote(parent,key){if(parent[key].length===0){return parent[key]={};}var t={};for(var i in parent[key]){t[i]=parent[key][i];}parent[key]=t;return t;}function parse(parts,parent,key,val){var part=parts.shift();if(!part){if(isArray(parent[key])){parent[key].push(val);}else{if("object"==typeof parent[key]){parent[key]=val;}else{if("undefined"==typeof parent[key]){parent[key]=val;}else{parent[key]=[parent[key],val];}}}}else{var obj=parent[key]=parent[key]||[];if("]"==part){if(isArray(obj)){if(""!==val){obj.push(val);}}else{if("object"==typeof obj){obj[keys(obj).length]=val;}else{obj=parent[key]=[parent[key],val];}}}else{if(~part.indexOf("]")){part=part.substr(0,part.length-1);if(!isint.test(part)&&isArray(obj)){obj=promote(parent,key);}parse(parts,obj,part,val);}else{if(!isint.test(part)&&isArray(obj)){obj=promote(parent,key);}parse(parts,obj,part,val);}}}}function merge(parent,key,val){if(~key.indexOf("]")){var parts=key.split("[");parse(parts,parent,"base",val);}else{if(!isint.test(key)&&isArray(parent.base)){var t={};for(var k in parent.base){t[k]=parent.base[k];}parent.base=t;}if(key!==""){set(parent.base,key,val);}}return parent;}function parseString(str){return reduce(String(str).split(/&|;/),function(ret,pair){try{pair=decodeURIComponent(pair.replace(/\+/g," "));}catch(e){}var eql=pair.indexOf("="),brace=lastBraceInKey(pair),key=pair.substr(0,brace||eql),val=pair.substr(brace||eql,pair.length);val=val.substr(val.indexOf("=")+1,val.length);if(key===""){key=pair;val="";}return merge(ret,key,val);},{base:{}}).base;}function set(obj,key,val){var v=obj[key];if(typeof v==="undefined"){obj[key]=val;}else{if(isArray(v)){v.push(val);}else{obj[key]=[v,val];}}}function lastBraceInKey(str){var len=str.length,brace,c;for(var i=0;i<len;++i){c=str[i];if("]"==c){brace=false;}if("["==c){brace=true;}if("="==c&&!brace){return i;}}return undefined;}function reduce(obj,accumulator){var i=0,l=obj.length>>0,curr=arguments[2];while(i<l){if(i in obj){curr=accumulator.call(undefined,curr,obj[i],i,obj);}++i;}return curr;}function isArray(vArg){return Object.prototype.toString.call(vArg)==="[object Array]";}function keys(obj){var key_array=[];for(var prop in obj){if(obj.hasOwnProperty(prop)){key_array.push(prop);}}return key_array;}function purl(url,strictMode){if(arguments.length===1&&url===true){strictMode=true;url=undefined;}strictMode=strictMode||false;url=url||window.location.toString();return{data:parseUri(url,strictMode),attr:function(attr){attr=aliases[attr]||attr;return typeof attr!=="undefined"?this.data.attr[attr]:this.data.attr;},param:function(param){return typeof param!=="undefined"?this.data.param.query[param]:this.data.param.query;},fparam:function(param){return typeof param!=="undefined"?this.data.param.fragment[param]:this.data.param.fragment;},segment:function(seg){if(typeof seg==="undefined"){return this.data.seg.path;}else{seg=seg<0?this.data.seg.path.length+seg:seg-1;return this.data.seg.path[seg];}},fsegment:function(seg){if(typeof seg==="undefined"){return this.data.seg.fragment;}else{seg=seg<0?this.data.seg.fragment.length+seg:seg-1;return this.data.seg.fragment[seg];}}};}_global.parse_string=parseString;_global.purl=purl;}(msos));msos.parse_query=function(){var url=msos.purl(),key="",cfg="",result=url.param();for(key in result){if(result.hasOwnProperty(key)){result[key]=result[key].replace(/[^0-9a-zA-Z_]/g,"_");if(result[key]==="true"){result[key]=true;}if(result[key]==="false"){result[key]=false;}}}for(cfg in msos.config){if(msos.config.hasOwnProperty(cfg)){if(result[cfg]||result[cfg]===false){msos.config[cfg]=result[cfg];}}}if(msos.config.verbose){msos.config.debug=true;}return result;};msos.config.query=msos.parse_query();msos.console=(function(){var console_obj={queue:[]},console_win=window.console,idx=msos.log_methods.length-1,aps=Array.prototype.slice,methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profiles","profileEnd","show","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],method=methods.pop();if(!console_win.memory){console_win.memory={};}while(method){if(!console_win[method]){console_win[method]=function(key){return function(){console.warn("msos.console -> method: "+key+" is na!");};}(method);}method=methods.pop();}function formatError(arg){if(arg instanceof Error){if(arg.stack){arg=(arg.message&&arg.stack.indexOf(arg.message)===-1)?"Error: "+arg.message+"\n"+arg.stack:arg.stack;}else{if(arg.sourceURL){arg=arg.message+"\n"+arg.sourceURL+":"+arg.line;}}}return arg;}while(idx>=0){(function(method){console_obj[method]=function(){if(!(method==="error"||method==="warn")&&!msos.config.debug){return;}var cfg=msos.config,filter=cfg.query.debug_filter||"",i=0,args=aps.apply(arguments),name=args[0]&&typeof args[0]==="string"?args[0].replace(/\W/g,"_"):"missing name or input",console_org=console_win[method]||console_win.log,log_output=[],out_args=[],message;if(method==="debug"&&cfg.verbose&&filter&&/^[0-9a-zA-Z.]+$/.test(filter)){filter=new RegExp("^"+filter.replace(".","."));if(!name.match(filter)){msos.console.warn("msos.console -> no match for debug filter: "+filter);return;}}if(method==="time"||method==="timeEnd"){msos.record_times[name+"_"+method]=(new Date()).getTime();}if(cfg.console){log_output=[method].concat(args);if(method==="time"||method==="timeEnd"){log_output.push(msos.record_times[name+"_"+method]);}console_obj.queue.push(log_output);}if(console_win){if(console_org.apply){for(i=0;i<args.length;i+=1){out_args.push(formatError(args[i]));}console_org.apply(console_win,out_args);}else{message=args.join(" ");console_org(message);}}};}(msos.log_methods[idx]));idx-=1;}return console_obj;}());msos.console.time("base");msos.console.debug("msos/base -> msos.console now available.");msos.console.debug("msos/base -> purl.js now available.");msos.site_specific=function(settings){var i=0,ms_db=msos.config.debugging,ms_qu=msos.config.query,set="";for(i=0;i<ms_db.length;i+=1){set=ms_db[i];if(typeof settings[set]==="boolean"){msos.config[set]=settings[set];}if(typeof ms_qu[set]==="boolean"){msos.config[set]=ms_qu[set];}}};(function(){var root=this;var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _){return obj;}if(!(this instanceof _)){return new _(obj);}this._wrapped=obj;};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_;}exports._=_;}else{root._=_;}_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(context===void 0){return func;}switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value);};case 2:return function(value,other){return func.call(context,value,other);};case 3:return function(value,index,collection){return func.call(context,value,index,collection);};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection);};}return function(){return func.apply(context,arguments);};};var cb=function(value,context,argCount){if(value==null){return _.identity;}if(_.isFunction(value)){return optimizeCb(value,context,argCount);}if(_.isObject(value)){return _.matcher(value);}return _.property(value);};_.iteratee=function(value,context){return cb(value,context,Infinity);};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(length<2||obj==null){return obj;}for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!undefinedOnly||obj[key]===void 0){obj[key]=source[key];}}}return obj;};};var baseCreate=function(prototype){if(!_.isObject(prototype)){return{};}if(nativeCreate){return nativeCreate(prototype);}Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result;};var property=function(key){return function(obj){return obj==null?void 0:obj[key];};};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=property("length");var isArrayLike=function(collection){var length=getLength(collection);return typeof length=="number"&&length>=0&&length<=MAX_ARRAY_INDEX;};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj);}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj);}}return obj;};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj);}return results;};function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj);}return memo;}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir;}return iterator(obj,iteratee,memo,keys,index,length);};}_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var key;if(isArrayLike(obj)){key=_.findIndex(obj,predicate,context);}else{key=_.findKey(obj,predicate,context);}if(key!==void 0&&key!==-1){return obj[key];}};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list)){results.push(value);}});return results;};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context);};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj)){return false;}}return true;};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj)){return true;}}return false;};_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){if(!isArrayLike(obj)){obj=_.values(obj);}if(typeof fromIndex!="number"||guard){fromIndex=0;}return _.indexOf(obj,item,fromIndex)>=0;};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return func==null?func:func.apply(value,args);});};_.pluck=function(obj,key){return _.map(obj,_.property(key));};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs));};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs));};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value>result){result=value;}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=value;lastComputed=computed;}});}return result;};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value<result){result=value;}}}else{iteratee=cb(iteratee,context);_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=value;lastComputed=computed;}});}return result;};_.shuffle=function(obj){var set=isArrayLike(obj)?obj:_.values(obj);var length=set.length;var shuffled=Array(length);for(var index=0,rand;index<length;index++){rand=_.random(0,index);if(rand!==index){shuffled[index]=shuffled[rand];}shuffled[rand]=set[index];}return shuffled;};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj)){obj=_.values(obj);}return obj[_.random(obj.length-1)];}return _.shuffle(obj).slice(0,Math.max(0,n));};_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0){return 1;}if(a<b||b===void 0){return -1;}}return left.index-right.index;}),"value");};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key);});return result;};};_.groupBy=group(function(result,value,key){if(_.has(result,key)){result[key].push(value);}else{result[key]=[value];}});_.indexBy=group(function(result,value,key){result[key]=value;});_.countBy=group(function(result,value,key){if(_.has(result,key)){result[key]++;}else{result[key]=1;}});_.toArray=function(obj){if(!obj){return[];}if(_.isArray(obj)){return slice.call(obj);}if(isArrayLike(obj)){return _.map(obj,_.identity);}return _.values(obj);};_.size=function(obj){if(obj==null){return 0;}return isArrayLike(obj)?obj.length:_.keys(obj).length;};_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value);});return[pass,fail];};_.first=_.head=_.take=function(array,n,guard){if(array==null){return void 0;}if(n==null||guard){return array[0];}return _.initial(array,array.length-n);};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)));};_.last=function(array,n,guard){if(array==null){return void 0;}if(n==null||guard){return array[array.length-1];}return _.rest(array,Math.max(0,array.length-n));};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n);};_.compact=function(array){return _.filter(array,_.identity);};var flatten=function(input,shallow,strict,startIndex){var output=[],idx=0;for(var i=startIndex||0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(!shallow){value=flatten(value,shallow,strict);}var j=0,len=value.length;output.length+=len;while(j<len){output[idx++]=value[j++];}}else{if(!strict){output[idx++]=value;}}}return output;};_.flatten=function(array,shallow){return flatten(array,shallow,false);};_.without=function(array){return _.difference(array,slice.call(arguments,1));};_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false;}if(iteratee!=null){iteratee=cb(iteratee,context);}var result=[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){if(!i||seen!==computed){result.push(value);}seen=computed;}else{if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value);}}else{if(!_.contains(result,value)){result.push(value);}}}}return result;};_.union=function(){return _.uniq(flatten(arguments,true,true));};_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item)){continue;}for(var j=1;j<argsLength;j++){if(!_.contains(arguments[j],item)){break;}}if(j===argsLength){result.push(item);}}return result;};_.difference=function(array){var rest=flatten(arguments,true,true,1);return _.filter(array,function(value){return !_.contains(rest,value);});};_.zip=function(){return _.unzip(arguments);};_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index);}return result;};_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}return result;};function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array)){return index;}}return -1;};}_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value){low=mid+1;}else{high=mid;}}return low;};function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=="number"){if(dir>0){i=idx>=0?idx:Math.max(idx+length,i);}else{length=idx>=0?Math.min(idx+1,length):idx+length+1;}}else{if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1;}}if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1;}for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir){if(array[idx]===item){return idx;}}return -1;};}_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,stop,step){if(stop==null){stop=start||0;start=0;}step=step||1;var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start;}return range;};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc)){return sourceFunc.apply(context,args);}var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result)){return result;}return self;};_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind){return nativeBind.apply(func,slice.call(arguments,1));}if(!_.isFunction(func)){throw new TypeError("Bind must be called on a function");}var args=slice.call(arguments,2);var bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)));};return bound;};_.partial=function(func){var boundArgs=slice.call(arguments,1);var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===_?arguments[position++]:boundArgs[i];}while(position<arguments.length){args.push(arguments[position++]);}return executeBound(func,bound,this,this,args);};return bound;};_.bindAll=function(obj){var i,length=arguments.length,key;if(length<=1){throw new Error("bindAll must be passed function names");}for(i=1;i<length;i++){key=arguments[i];obj[key]=_.bind(obj[key],obj);}return obj;};_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=""+(hasher?hasher.apply(this,arguments):key);if(!_.has(cache,address)){cache[address]=func.apply(this,arguments);}return cache[address];};memoize.cache={};return memoize;};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args);},wait);};_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options){options={};}var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout){context=args=null;}};return function(){var now=_.now();if(!previous&&options.leading===false){previous=now;}var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null;}previous=now;result=func.apply(context,args);if(!timeout){context=args=null;}}else{if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}}return result;};};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;var later=function(){var last=_.now()-timestamp;if(last<wait&&last>=0){timeout=setTimeout(later,wait-last);}else{timeout=null;if(!immediate){result=func.apply(context,args);if(!timeout){context=args=null;}}}};return function(){context=this;args=arguments;timestamp=_.now();var callNow=immediate&&!timeout;if(!timeout){timeout=setTimeout(later,wait);}if(callNow){result=func.apply(context,args);context=args=null;}return result;};};_.wrap=function(func,wrapper){return _.partial(wrapper,func);};_.negate=function(predicate){return function(){return !predicate.apply(this,arguments);};};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--){result=args[i].call(this,result);}return result;};};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments);}};};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments);}if(times<=1){func=null;}return memo;};};_.once=_.partial(_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString");var nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=(_.isFunction(constructor)&&constructor.prototype)||ObjProto;var prop="constructor";if(_.has(obj,prop)&&!_.contains(keys,prop)){keys.push(prop);}while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop);}}}_.keys=function(obj){if(!_.isObject(obj)){return[];}if(nativeKeys){return nativeKeys(obj);}var keys=[];for(var key in obj){if(_.has(obj,key)){keys.push(key);}}if(hasEnumBug){collectNonEnumProps(obj,keys);}return keys;};_.allKeys=function(obj){if(!_.isObject(obj)){return[];}var keys=[];for(var key in obj){keys.push(key);}if(hasEnumBug){collectNonEnumProps(obj,keys);}return keys;};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]];}return values;};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={},currentKey;for(var index=0;index<length;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj);}return results;};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]];}return pairs;};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key])){names.push(key);}}return names.sort();};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj)){return key;}}};_.pick=function(object,oiteratee,context){var result={},obj=object,iteratee,keys;if(obj==null){return result;}if(_.isFunction(oiteratee)){keys=_.allKeys(obj);iteratee=optimizeCb(oiteratee,context);}else{keys=flatten(arguments,false,false,1);iteratee=function(value,key,obj){return key in obj;};obj=Object(obj);}for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj)){result[key]=value;}}return result;};_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee)){iteratee=_.negate(iteratee);}else{var keys=_.map(flatten(arguments,false,false,1),String);iteratee=function(value,key){return !_.contains(keys,key);};}return _.pick(obj,iteratee,context);};_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props){_.extendOwn(result,props);}return result;};_.clone=function(obj){if(!_.isObject(obj)){return obj;}return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null){return !length;}var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj)){return false;}}return true;};var eq=function(a,b,aStack,bStack){if(a===b){return a!==0||1/a===1/b;}if(a==null||b==null){return a===b;}if(a instanceof _){a=a._wrapped;}if(b instanceof _){b=b._wrapped;}var className=toString.call(a);if(className!==toString.call(b)){return false;}switch(className){case"[object RegExp]":case"[object String]":return""+a===""+b;case"[object Number]":if(+a!==+a){return +b!==+b;}return +a===0?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return +a===+b;}var areArrays=className==="[object Array]";if(!areArrays){if(typeof a!="object"||typeof b!="object"){return false;}var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&("constructor" in a&&"constructor" in b)){return false;}}aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a){return bStack[length]===b;}}aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length){return false;}while(length--){if(!eq(a[length],b[length],aStack,bStack)){return false;}}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length){return false;}while(length--){key=keys[length];if(!(_.has(b,key)&&eq(a[key],b[key],aStack,bStack))){return false;}}}aStack.pop();bStack.pop();return true;};_.isEqual=function(a,b){return eq(a,b);};_.isEmpty=function(obj){if(obj==null){return true;}if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))){return obj.length===0;}return _.keys(obj).length===0;};_.isElement=function(obj){return !!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==="[object Array]";};_.isObject=function(obj){var type=typeof obj;return type==="function"||type==="object"&&!!obj;};_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]";};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return _.has(obj,"callee");};}if(typeof/./!="function"&&typeof Int8Array!="object"){_.isFunction=function(obj){return typeof obj=="function"||false;};}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj));};_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj;};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==="[object Boolean]";};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,key){return obj!=null&&hasOwnProperty.call(obj,key);};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.constant=function(value){return function(){return value;};};_.noop=function(){};_.property=property;_.propertyOf=function(obj){return obj==null?function(){}:function(key){return obj[key];};};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs);};};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++){accum[i]=iteratee(i);}return accum;};_.random=function(min,max){if(max==null){max=min;min=0;}return min+Math.floor(Math.random()*(max-min+1));};_.now=Date.now||function(){return new Date().getTime();};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match];};var source="(?:"+_.keys(map).join("|")+")";var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,"g");return function(string){string=string==null?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string;};};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(object,property,fallback){var value=object==null?void 0:object[property];if(value===void 0){value=fallback;}return _.isFunction(value)?value.call(object):value;};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return"\\"+escapes[match];};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings){settings=oldSettings;}settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";}else{if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";}else{if(evaluate){source+="';\n"+evaluate+"\n__p+='";}}}return match;});source+="';\n";if(!settings.variable){source="with(obj||{}){\n"+source+"}\n";}source="var __t,__p='',__j=Array.prototype.join,"+"print=function (){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source);}catch(e){e.source=source;msos.console.debug("msos/base - _.template -> error:",e);throw e;}var template=function(data){if(msos.config.verbose){msos.console.debug("msos/base - _.template -> called, for data:",data);}return render.call(this,data,_);};var argument=settings.variable||"obj";template.source="function ("+argument+"){\n"+source+"}";return template;};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance;};var result=function(instance,obj){return instance._chain?_(obj).chain():obj;};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(_,args));};});};_.mixin(_);_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==="shift"||name==="splice")&&obj.length===0){delete obj[0];}return result(this,obj);};});_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments));};});_.prototype.value=function(){return this._wrapped;};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return""+this._wrapped;};if(typeof define==="function"&&define.amd){define("underscore",[],function(){return _;});}msos.console.debug("msos/base -> underscore.js now available.");}.call(this));
/*!
 * modernizr v3.2.0
 *
 * Copyright (c)
 *  Faruk Ates
 *  Paul Irish
 *  Alex Sexton
 *  Ryan Seddon
 *  Patrick Kettner
 *  Stu Cox
 *  Richard Herrera

 * MIT License
 */
(function(window,document){var tests=[],classes=[],ModernizrProto={_version:"3.2.0",_config:{"classPrefix":"","enableClasses":true,"enableJSClass":true,"usePrefixes":true},_q:[],on:function(test,cb){var self=this;setTimeout(function(){cb(self[test]);},0);},addTest:function(name,fn,options){tests.push({name:name,fn:fn,options:options});},addAsyncTest:function(fn){tests.push({name:null,fn:fn});}},Modernizr=function(){},docElement=document.documentElement,prefixes,newSyntax,oldSyntax,isSVG=docElement.nodeName.toLowerCase()==="svg",hasEvent,testStyles,inputElem,inputtypes=["search","tel","url","email","datetime","date","month","week","time","datetime-local","number","range","color"],inputs={},domPrefixes,cssomPrefixes,modElem,mStyle,omPrefixes="Moz O ms Webkit",i=0;function createElement(){if(typeof document.createElement!=="function"){return document.createElement(arguments[0]);}if(isSVG){return document.createElementNS.call(document,"http://www.w3.org/2000/svg",arguments[0]);}return document.createElement.apply(document,arguments);}inputElem=createElement("input");Modernizr.prototype=ModernizrProto;Modernizr=new Modernizr();Modernizr.addTest("geolocation","geolocation" in navigator);Modernizr.addTest("websockets","WebSocket" in window&&window.WebSocket.CLOSING===2);Modernizr.addTest("devicemotion","DeviceMotionEvent" in window);Modernizr.addTest("deviceorientation","DeviceOrientationEvent" in window);Modernizr.addTest("localstorage",function(){var mod="modernizr";try{localStorage.setItem(mod,mod);localStorage.removeItem(mod);return true;}catch(e){return false;}});Modernizr.addTest("sessionstorage",function(){var mod="modernizr";try{sessionStorage.setItem(mod,mod);sessionStorage.removeItem(mod);return true;}catch(e){return false;}});Modernizr.addTest("websqldatabase","openDatabase" in window);Modernizr.addTest("cors","XMLHttpRequest" in window&&"withCredentials" in new XMLHttpRequest());Modernizr.addTest("dataset",function(){var n=createElement("div");n.setAttribute("data-a-b","c");return !!(n.dataset&&n.dataset.aB==="c");});function is(obj,type){return typeof obj===type;}function testRunner(){var featureNames,feature,aliasIdx,result,nameIdx,featureName,featureNameSplit,featureIdx;for(featureIdx in tests){if(tests.hasOwnProperty(featureIdx)){featureNames=[];feature=tests[featureIdx];if(feature.name){featureNames.push(feature.name.toLowerCase());if(feature.options&&feature.options.aliases&&feature.options.aliases.length){for(aliasIdx=0;aliasIdx<feature.options.aliases.length;aliasIdx+=1){featureNames.push(feature.options.aliases[aliasIdx].toLowerCase());}}}result=is(feature.fn,"function")?feature.fn():feature.fn;for(nameIdx=0;nameIdx<featureNames.length;nameIdx+=1){featureName=featureNames[nameIdx];featureNameSplit=featureName.split(".");if(featureNameSplit.length===1){Modernizr[featureNameSplit[0]]=result;}else{if(Modernizr[featureNameSplit[0]]&&!(Modernizr[featureNameSplit[0]] instanceof Boolean)){Modernizr[featureNameSplit[0]]=new Boolean(Modernizr[featureNameSplit[0]]);}Modernizr[featureNameSplit[0]][featureNameSplit[1]]=result;}classes.push((result?"":"no-")+featureNameSplit.join("-"));}}}}prefixes=(ModernizrProto._config.usePrefixes?["-webkit-","-moz-","-o-","-ms-"]:[]);ModernizrProto._prefixes=prefixes;newSyntax="CSS" in window&&"supports" in window.CSS;oldSyntax="supportsCSS" in window;Modernizr.addTest("supports",newSyntax||oldSyntax);hasEvent=(function(){var needsFallback=!("onblur" in document.documentElement);function inner(eventName,element){var isSupported;if(!eventName){return false;}if(!element||typeof element==="string"){element=createElement(element||"div");}eventName="on"+eventName;isSupported=eventName in element;if(!isSupported&&needsFallback){if(!element.setAttribute){element=createElement("div");}element.setAttribute(eventName,"");isSupported=typeof element[eventName]==="function";if(element[eventName]!==undefined){element[eventName]=undefined;}element.removeAttribute(eventName);}return isSupported;}return inner;}());ModernizrProto.hasEvent=hasEvent;Modernizr.addTest("audio",function(){var elem=createElement("audio"),bool=false;try{bool=!!elem.canPlayType;if(bool){bool=new Boolean(bool);bool.ogg=elem.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"");bool.mp3=elem.canPlayType("audio/mpeg;").replace(/^no$/,"");bool.opus=elem.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"");bool.wav=elem.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"");bool.m4a=(elem.canPlayType("audio/x-m4a;")||elem.canPlayType("audio/aac;")).replace(/^no$/,"");}}catch(e){}return bool;});Modernizr.addTest("contenteditable",function(){if(!("contentEditable" in docElement)){return false;}var div=createElement("div");div.contentEditable=true;return div.contentEditable==="true";});Modernizr.addTest("video",function(){var elem=createElement("video"),bool=false;try{bool=!!elem.canPlayType;if(bool){bool=new Boolean(bool);bool.ogg=elem.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"");bool.h264=elem.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"");bool.webm=elem.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"");bool.vp9=elem.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"");bool.hls=elem.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"");}}catch(e){}return bool;});Modernizr.addTest("cssgradients",function(){var str1="background-image:",str2="gradient(linear,left top,right bottom,from(#9f9),to(white));",css="",angle,i=0,len,elem,style;for(i=0,len=prefixes.length-1;i<len;i+=1){angle=(i===0?"to ":"");css+=str1+prefixes[i]+"linear-gradient("+angle+"left top, #9f9, white);";}if(Modernizr._config.usePrefixes){css+=str1+"-webkit-"+str2;}elem=createElement("a");style=elem.style;style.cssText=css;return(""+style.backgroundImage).indexOf("gradient")>-1;});Modernizr.addTest("csspointerevents",function(){var style=createElement("a").style;style.cssText="pointer-events:auto";return style.pointerEvents==="auto";});Modernizr.addTest("formattribute",function(){var form=createElement("form"),input=createElement("input"),div=createElement("div"),id="formtest"+(new Date()).getTime(),attr,bool=false;form.id=id;try{input.setAttribute("form",id);}catch(e){if(document.createAttribute){attr=document.createAttribute("form");attr.nodeValue=id;input.setAttributeNode(attr);}}div.appendChild(form);div.appendChild(input);docElement.appendChild(div);bool=form.elements&&form.elements.length===1&&input.form==form;div.parentNode.removeChild(div);return bool;});function getBody(){var body=document.body;if(!body){body=createElement(isSVG?"svg":"body");body.fake=true;}return body;}domPrefixes=(ModernizrProto._config.usePrefixes?omPrefixes.toLowerCase().split(" "):[]);ModernizrProto._domPrefixes=domPrefixes;Modernizr.addTest("pointerevents",function(){var bool=false,i=domPrefixes.length;bool=Modernizr.hasEvent("pointerdown");while(i--&&!bool){if(hasEvent(domPrefixes[i]+"pointerdown")){bool=true;}}return bool;});function injectElementWithStyles(rule,callback,nodes,testnames){var mod="modernizr",style,ret,node,docOverflow,div=createElement("div"),body=getBody(),oh;if(parseInt(nodes,10)){while(nodes--){node=createElement("div");node.id=testnames?testnames[nodes]:mod+(nodes+1);div.appendChild(node);}}style=createElement("style");style.type="text/css";style.id="s"+mod;(!body.fake?div:body).appendChild(style);body.appendChild(div);if(style.styleSheet){style.styleSheet.cssText=rule;}else{style.appendChild(document.createTextNode(rule));}div.id=mod;if(body.fake){body.style.background="";body.style.overflow="hidden";docOverflow=docElement.style.overflow;docElement.style.overflow="hidden";docElement.appendChild(body);}ret=callback(div,rule);if(body.fake){body.parentNode.removeChild(body);docElement.style.overflow=docOverflow;oh=docElement.offsetHeight;}else{div.parentNode.removeChild(div);}return !!ret;}testStyles=ModernizrProto.testStyles=injectElementWithStyles;Modernizr.addTest("touchevents",function(){var bool,query;if(("ontouchstart" in window)||(window.DocumentTouch&&document instanceof DocumentTouch)){bool=true;}else{query=["@media (",prefixes.join("touch-enabled),("),"heartz",")","{#modernizr{top:9px;position:absolute}}"].join("");testStyles(query,function(node){bool=node.offsetTop===9;});}return bool;});Modernizr.addTest("formvalidation",function(){var form=createElement("form"),invalidFired=false,input;if(!("checkValidity" in form)||!("addEventListener" in form)){return false;}if("reportValidity" in form){return true;}Modernizr.formvalidationapi=true;form.addEventListener("submit",function(e){if(!window.opera||window.operamini){e.preventDefault();}e.stopPropagation();},false);form.innerHTML='<input name="modTest" required><button></button>';testStyles("#modernizr form{position:absolute;top:-99999em}",function(node){node.appendChild(form);input=form.getElementsByTagName("input")[0];input.addEventListener("invalid",function(e){invalidFired=true;e.preventDefault();e.stopPropagation();},false);Modernizr.formvalidationmessage=!!input.validationMessage;form.getElementsByTagName("button")[0].click();});return invalidFired;});Modernizr.inputtypes=(function(props){var i=0,len=props.length,smile=":)",inputElemType,defaultView,bool;for(i=0;i<len;i+=1){inputElem.setAttribute("type",inputElemType=props[i]);bool=inputElem.type!=="text"&&"style" in inputElem;if(bool){inputElem.value=smile;inputElem.style.cssText="position:absolute;visibility:hidden;";if(/^range$/.test(inputElemType)&&inputElem.style.WebkitAppearance!==undefined){docElement.appendChild(inputElem);defaultView=document.defaultView;bool=defaultView.getComputedStyle&&defaultView.getComputedStyle(inputElem,null).WebkitAppearance!=="textfield"&&(inputElem.offsetHeight!==0);docElement.removeChild(inputElem);}else{if(/^(search|tel)$/.test(inputElemType)){}else{if(/^(url|email|number)$/.test(inputElemType)){bool=inputElem.checkValidity&&inputElem.checkValidity()===false;}else{bool=inputElem.value!==smile;}}}}inputs[props[i]]=!!bool;}return inputs;}(inputtypes));Modernizr.addTest("localizednumber",function(){if(!Modernizr.inputtypes.number){return false;}if(!Modernizr.formvalidation){return false;}var el=createElement("div"),diff,body=getBody(),root=(function(){return docElement.insertBefore(body,docElement.firstElementChild||docElement.firstChild);}()),input;el.innerHTML='<input type="number" value="1.0" step="0.1"/>';input=el.childNodes[0];root.appendChild(el);input.focus();try{document.execCommand("InsertText",false,"1,1");}catch(e){}diff=input.type==="number"&&input.valueAsNumber===1.1&&input.checkValidity();root.removeChild(el);body.fake&&root.parentNode.removeChild(root);return diff;});cssomPrefixes=(ModernizrProto._config.usePrefixes?omPrefixes.split(" "):[]);ModernizrProto._cssomPrefixes=cssomPrefixes;function contains(str,substr){return !!~(""+str).indexOf(substr);}function cssToDOM(name){return name.replace(/([a-z])-([a-z])/g,function(str,m1,m2){return m1+m2.toUpperCase();}).replace(/^-/,"");}function fnBind(fn,that){return function(){return fn.apply(that,arguments);};}function testDOMProps(props,obj,elem){var item,pro;for(pro in props){if(props[pro] in obj){if(elem===false){return props[pro];}item=obj[props[pro]];if(is(item,"function")){return fnBind(item,elem||obj);}return item;}}return false;}modElem={elem:createElement("modernizr")};Modernizr._q.push(function(){delete modElem.elem;});mStyle={style:modElem.elem.style};Modernizr._q.unshift(function(){delete mStyle.style;});function domToCSS(name){return name.replace(/([A-Z])/g,function(str,m1){return"-"+m1.toLowerCase();}).replace(/^ms-/,"-ms-");}function nativeTestProps(props,value){var i=props.length,conditionText=[];if("CSS" in window&&"supports" in window.CSS){while(i--){if(window.CSS.supports(domToCSS(props[i]),value)){return true;}}return false;}else{if("CSSSupportsRule" in window){while(i--){conditionText.push("("+domToCSS(props[i])+":"+value+")");}conditionText=conditionText.join(" or ");return injectElementWithStyles("@supports ("+conditionText+") { #modernizr { position: absolute; } }",function(node){return getComputedStyle(node,null).position==="absolute";});}}return undefined;}function testProps(props,prefixed,value,skipValueTest){skipValueTest=is(skipValueTest,"undefined")?false:skipValueTest;var result,afterInit,elems=["modernizr","tspan"],i=0,propsLength,prop,before;if(!is(value,"undefined")){result=nativeTestProps(props,value);if(!is(result,"undefined")){return result;}}while(!mStyle.style){afterInit=true;mStyle.modElem=createElement(elems.shift());mStyle.style=mStyle.modElem.style;}function cleanElems(){if(afterInit){delete mStyle.style;delete mStyle.modElem;}}propsLength=props.length;for(i=0;i<propsLength;i+=1){prop=props[i];before=mStyle.style[prop];if(contains(prop,"-")){prop=cssToDOM(prop);}if(mStyle.style[prop]!==undefined){if(!skipValueTest&&!is(value,"undefined")){try{mStyle.style[prop]=value;}catch(e){}if(mStyle.style[prop]!=before){cleanElems();return prefixed==="pfx"?prop:true;}}else{cleanElems();return prefixed==="pfx"?prop:true;}}}cleanElems();return false;}function testPropsAll(prop,prefixed,elem,value,skipValueTest){var ucProp=prop.charAt(0).toUpperCase()+prop.slice(1),props=(prop+" "+cssomPrefixes.join(ucProp+" ")+ucProp).split(" ");if(is(prefixed,"string")||is(prefixed,"undefined")){return testProps(props,prefixed,value,skipValueTest);}props=(prop+" "+(domPrefixes).join(ucProp+" ")+ucProp).split(" ");return testDOMProps(props,prefixed,elem);}ModernizrProto.testAllProps=testPropsAll;function testAllProps(prop,value,skipValueTest){return testPropsAll(prop,undefined,undefined,value,skipValueTest);}ModernizrProto.testAllProps=testAllProps;Modernizr.addTest("cssanimations",testAllProps("animationName","a",true));Modernizr.addTest("overflowscrolling",testAllProps("overflowScrolling","touch",true));Modernizr.addTest("boxshadow",testAllProps("boxShadow","1px 1px",true));Modernizr.addTest("csstransforms",function(){return navigator.userAgent.indexOf("Android 2.")===-1&&testAllProps("transform","scale(1)",true);});Modernizr.addTest("csstransforms3d",function(){var ret=!!testAllProps("perspective","1px",true),usePrefix=Modernizr._config.usePrefixes,mq,defaultStyle="#modernizr{width:0;height:0}";if(ret&&(!usePrefix||"webkitPerspective" in docElement.style)){if(Modernizr.supports){mq="@supports (perspective: 1px)";}else{mq="@media (transform-3d)";if(usePrefix){mq+=",(-webkit-transform-3d)";}}mq+="{#modernizr{width:7px;height:18px;margin:0;padding:0;border:0}}";testStyles(defaultStyle+mq,function(elem){ret=elem.offsetWidth===7&&elem.offsetHeight===18;});}return ret;});Modernizr.addTest("csstransitions",testAllProps("transition","all",true));testRunner();delete ModernizrProto.addTest;delete ModernizrProto.addAsyncTest;for(i=0;i<Modernizr._q.length;i+=1){Modernizr._q[i]();}window.Modernizr=Modernizr;msos.console.debug("msos/base -> Modernizr.js now available.");}(window,document));(function(){var Basil=function(options){return _.extend({},Basil.plugins,new Basil.Storage().init(options));};Basil.version="0.4.2";Basil.utils={each:function(obj,fnIterator,context){if(_.isArray(obj)){for(var i=0;i<obj.length;i++){if(fnIterator.call(context,obj[i],i)===false){return;}}}else{if(obj){for(var key in obj){if(fnIterator.call(context,obj[key],key)===false){return;}}}}},tryEach:function(obj,fnIterator,fnError,context){this.each(obj,function(value,key){try{return fnIterator.call(context,value,key);}catch(error){if(_.isFunction(fnError)){try{fnError.call(context,value,key,error);}catch(error){msos.console.error("msos/base - Basil.tryEach -> failed:",error);}}}return undefined;},this);},registerPlugin:function(methods){Basil.plugins=_.extend(methods,Basil.plugins);}};Basil.plugins={};Basil.options=_.extend({namespace:"msos_b45i1",storages:["local","cookie","session","memory"],expireDays:31},window.Basil?window.Basil.options:{});Basil.Storage=function(){var _salt="b45i1"+(Math.random()+1).toString(36).substring(7),_storages={},_toStoragesArray=function(storages){if(_.isArray(storages)){return storages;}return _.isString(storages)?[storages]:[];},_toStoredKey=function(namespace,path){var key="";if(_.isString(path)&&path.length){path=[path];}if(_.isArray(path)&&path.length){key=path.join(":");}return key&&namespace?namespace+":"+key:key;},_toKeyName=function(namespace,key){if(!namespace){return key;}return key.replace(new RegExp("^"+namespace+":"),"");},_toStoredValue=function(value){return JSON.stringify(value);},_fromStoredValue=function(value){return value?JSON.parse(value):null;};var webStorageInterface={engine:null,check:function(){try{window[this.engine].setItem(_salt,true);window[this.engine].removeItem(_salt);}catch(e){msos.console.warn("msos/base - Basil.check -> response:",e);return false;}return true;},set:function(key,value,options){if(!key){throw Error("invalid key");}window[this.engine].setItem(key,value);},get:function(key){return window[this.engine].getItem(key);},remove:function(key){window[this.engine].removeItem(key);},reset:function(namespace){for(var i=0,key;i<window[this.engine].length;i++){key=window[this.engine].key(i);if(!namespace||key.indexOf(namespace)===0){this.remove(key);i--;}}},keys:function(namespace){var keys=[];for(var i=0,key;i<window[this.engine].length;i++){key=window[this.engine].key(i);if(!namespace||key.indexOf(namespace)===0){keys.push(_toKeyName(namespace,key));}}return keys;}};_storages.local=_.extend({},webStorageInterface,{engine:"localStorage"});_storages.session=_.extend({},webStorageInterface,{engine:"sessionStorage"});_storages.memory={_hash:{},check:function(){return true;},set:function(key,value,options){if(!key){throw Error("invalid key");}this._hash[key]=value;},get:function(key){return this._hash[key]||null;},remove:function(key){delete this._hash[key];},reset:function(namespace){for(var key in this._hash){if(!namespace||key.indexOf(namespace)===0){this.remove(key);}}},keys:function(namespace){var keys=[];for(var key in this._hash){if(!namespace||key.indexOf(namespace)===0){keys.push(_toKeyName(namespace,key));}}return keys;}};_storages.cookie={check:function(){return navigator.cookieEnabled;},set:function(key,value,options){if(!this.check()){throw Error("cookies are disabled");}options=options||{};if(!key){throw Error("invalid key");}var cookie=encodeURIComponent(key)+"="+encodeURIComponent(value);if(options.expireDays){var date=new Date();date.setTime(date.getTime()+(options.expireDays*24*60*60*1000));cookie+="; expires="+date.toGMTString();}if(options.domain&&options.domain!==document.domain){var _domain=options.domain.replace(/^\./,"");if(document.domain.indexOf(_domain)===-1||_domain.split(".").length<=1){throw Error("invalid domain");}cookie+="; domain="+options.domain;}if(options.secure===true){cookie+="; secure";}document.cookie=cookie+"; path=/";},get:function(key){if(!this.check()){throw Error("cookies are disabled");}var encodedKey=encodeURIComponent(key);var cookies=document.cookie?document.cookie.split(";"):[];for(var i=cookies.length-1,cookie;i>=0;i--){cookie=cookies[i].replace(/^\s*/,"");if(cookie.indexOf(encodedKey+"=")===0){return decodeURIComponent(cookie.substring(encodedKey.length+1,cookie.length));}}return null;},remove:function(key){this.set(key,"",{expireDays:-1});var domainParts=document.domain.split(".");for(var i=domainParts.length;i>=0;i--){this.set(key,"",{expireDays:-1,domain:"."+domainParts.slice(-i).join(".")});}},reset:function(namespace){var cookies=document.cookie?document.cookie.split(";"):[];for(var i=0,cookie,key;i<cookies.length;i++){cookie=cookies[i].replace(/^\s*/,"");key=cookie.substr(0,cookie.indexOf("="));if(!namespace||key.indexOf(namespace)===0){this.remove(key);}}},keys:function(namespace){if(!this.check()){throw Error("cookies are disabled");}var keys=[],cookies=document.cookie?document.cookie.split(";"):[];for(var i=0,cookie,key;i<cookies.length;i++){cookie=cookies[i].replace(/^\s*/,"");key=decodeURIComponent(cookie.substr(0,cookie.indexOf("=")));if(!namespace||key.indexOf(namespace)===0){keys.push(_toKeyName(namespace,key));}}return keys;}};return{init:function(options){this.setOptions(options);return this;},setOptions:function(options){this.options=_.extend({},this.options||Basil.options,options);},support:function(storage){return _storages.hasOwnProperty(storage);},check:function(storage){if(this.support(storage)){return _storages[storage].check();}return false;},set:function(key,value,options){if(msos.config.verbose){msos.console.debug("msos/base - Basil.set -> called, key: "+key);}options=_.extend({},this.options,options);if(!(key=_toStoredKey(options.namespace,key))){return false;}value=options.raw===true?value:_toStoredValue(value);var where=null;Basil.utils.tryEach(_toStoragesArray(options.storages),function(storage,index){_storages[storage].set(key,value,options);where=storage;return false;},null,this);if(!where){return false;}Basil.utils.tryEach(_toStoragesArray(options.storages),function(storage,index){if(storage!==where){_storages[storage].remove(key);}},null,this);return true;},get:function(key,options){if(msos.config.verbose){msos.console.debug("msos/base - Basil.get -> start, key: "+key);}options=_.extend({},this.options,options);if(!(key=_toStoredKey(options.namespace,key))){return null;}var value=null;Basil.utils.tryEach(_toStoragesArray(options.storages),function(storage,index){if(value!==null){return false;}value=_storages[storage].get(key,options)||null;value=options.raw===true?value:_fromStoredValue(value);return true;},function(storage,index,error){value=null;},this);if(msos.config.verbose){msos.console.debug("msos/base - Basil.get ->  done, key: "+key+", value:",value);}return value;},remove:function(key,options){if(msos.config.verbose){msos.console.debug("msos/base - Basil.remove -> called, key: "+key);}options=_.extend({},this.options,options);if(!(key=_toStoredKey(options.namespace,key))){return;}Basil.utils.tryEach(_toStoragesArray(options.storages),function(storage){_storages[storage].remove(key);},null,this);},reset:function(options){if(msos.config.verbose){msos.console.debug("msos/base - Basil.reset -> called.");}options=_.extend({},this.options,options);Basil.utils.tryEach(_toStoragesArray(options.storages),function(storage){_storages[storage].reset(options.namespace);},null,this);},keys:function(options){options=options||{};var keys=[];for(var key in this.keysMap(options)){keys.push(key);}return keys;},keysMap:function(options){options=_.extend({},this.options,options);var map={};Basil.utils.tryEach(_toStoragesArray(options.storages),function(storage){Basil.utils.each(_storages[storage].keys(options.namespace),function(key){map[key]=_.isArray(map[key])?map[key]:[];map[key].push(storage);},this);},null,this);return map;}};};Basil.memory=new Basil.Storage().init({storages:"memory",namespace:null,raw:true});Basil.cookie=new Basil.Storage().init({storages:"cookie",namespace:null,raw:true});Basil.localStorage=new Basil.Storage().init({storages:"local",namespace:null,raw:true});Basil.sessionStorage=new Basil.Storage().init({storages:"session",namespace:null,raw:true});window.Basil=Basil;msos.console.debug("msos/base -> basil.js now available.");}());msos.basil=new window.Basil();if(msos.config.clear_storage){msos.basil.reset();}if(msos.config.verbose){msos.console.debug("msos/base -> storage availability,\n        cookies: "+msos.basil.check("cookie")+",\n   localStorage: "+msos.basil.check("local")+",\n sessionStorage: "+msos.basil.check("session"));msos.basil.get("last_script_exec");msos.basil.set("last_script_exec",(new Date()));}(function(root,name,make){root[name]=make();}(msos,"verge",function(){var xports={},win=window!==undefined&&window,doc=document!==undefined&&document,docElem=doc&&doc.documentElement,matchMedia=win.matchMedia||win.msMatchMedia,mq=matchMedia?function(q){return !!matchMedia.call(win,q).matches;}:function(){return false;};xports.viewportW=function(){var a=docElem.clientWidth,b=win.innerWidth;return a<b?b:a;};xports.viewportH=function(){var a=docElem.clientHeight,b=win.innerHeight;return a<b?b:a;};xports.mq=mq;xports.matchMedia=matchMedia?function(){return matchMedia.apply(win,arguments);}:function(){return{};};xports.viewport=function(){return{"width":xports.viewportW(),"height":xports.viewportH()};};xports.scrollX=function(){return win.pageXOffset||docElem.scrollLeft;};xports.scrollY=function(){return win.pageYOffset||docElem.scrollTop;};function calibrate(coords,cushion){var o={};cushion=+cushion||0;o.right=coords.right+cushion;o.left=coords.left-cushion;o.bottom=coords.bottom+cushion;o.top=coords.top-cushion;o.width=o.right-o.left;o.height=o.bottom-o.top;return o;}xports.rectangle=function(el,cushion){el=el&&!el.nodeType?el[0]:el;if(!el||1!==el.nodeType){return false;}return calibrate(el.getBoundingClientRect(),cushion);};xports.aspect=function(o){o=o===undefined?xports.viewport():1===o.nodeType?xports.rectangle(o):o;var h=o.height,w=o.width;h=typeof h==="function"?h.call(o):h;w=typeof w==="function"?w.call(o):w;return w/h;};xports.inX=function(el,cushion){var r=xports.rectangle(el,cushion);return !!r&&r.right>=0&&r.left<=xports.viewportW();};xports.inY=function(el,cushion){var r=xports.rectangle(el,cushion);return !!r&&r.bottom>=0&&r.top<=xports.viewportH();};xports.inViewport=function(el,cushion){var r=xports.rectangle(el,cushion);return !!r&&r.bottom>=0&&r.right>=0&&r.top<=xports.viewportH()&&r.left<=xports.viewportW();};return xports;}));_.keys(msos.config.size_wide).map(function(k){return[k,msos.config.size_wide[k]];}).sort(function(a,b){if(a[1]<b[1]){return -1;}if(a[1]>b[1]){return 1;}return 0;}).forEach(function(d){msos.config.size_array.push(d[0]);});msos.var_is_null=function(variable){if(variable===undefined){return true;}if(variable===null){return true;}return false;};msos.var_is_empty=function(variable){if(msos.var_is_null(variable)){return true;}if(variable===""){return true;}return false;};msos.do_nothing=function(evt){evt.preventDefault();evt.stopPropagation();};msos.do_abs_nothing=function(evt){evt.preventDefault();evt.stopImmediatePropagation();};msos.new_time=function(){return(new Date()).getTime();};msos.set_version=function(mjr,mnr,pth){var self=this;self={major:mjr,minor:mnr,patch:pth,toString:function(){return"v"+self.major+"."+self.minor+"."+self.patch;}};return self;};msos.gen_namespace=function(b){var a=window,c=0;b=b.split(".");for(c=0;c<b.length;c+=1){a=a[b[c]]||(a[b[c]]={});}return a;};msos.generate_url_name=function(url){var path,parts=[],name="";path=msos.purl(url).attr("path");parts=path.split("/");name=parts.slice(2).join(":");name=name.replace(/[^0-9a-zA-Z]/g,"_");return name;};msos.run_function_array=function(name){var temp_fa="msos.run_func_array -> ",m=0;name=name||"missing";msos.console.debug(temp_fa+"start: "+name);if(!msos[name]||!(_.isArray(msos[name]))){msos.console.error(temp_fa+"for: "+name+", failed.");return;}for(m=0;m<msos[name].length;m+=1){if(msos.config.debug){msos.console.debug(temp_fa+"index: "+m+", for: "+name);try{msos[name][m]();}catch(e){msos.console.error(temp_fa+"for: "+name,e);}}else{msos[name][m]();}}msos[name]=[];msos.console.debug(temp_fa+" done: "+name);};msos.get_js_base=function(){var temp_gsl="msos.get_js_base -> ",scripts_array,current_script,script_url;msos.console.debug(temp_gsl+"start.");scripts_array=document.getElementsByTagName("script");current_script=scripts_array[scripts_array.length-1];script_url=current_script.src;script_url=script_url.slice(0,script_url.lastIndexOf("/")+1)||"";if(!script_url){throw new Error(temp_gsl+"failed!");}msos.console.debug(temp_gsl+"done, uri: "+script_url);return script_url;};msos.base_script_url=msos.get_js_base();msos.resource_url=function(folder,resource_file){return msos.base_script_url.replace(/\/msos\//,"/"+(folder?folder+"/":""))+resource_file;};msos.set_locale=function(){var temp_gl="msos.set_locale -> ",cfg=msos.config,store_obj=cfg.storage.site_i18n,store_array=[];if(store_obj.value){store_array=store_obj.value.split(":");}msos.console.debug(temp_gl+"start, stored local: "+(store_obj.value||"na"));cfg.locale=cfg.query.locale||store_array[0]||cfg.locale||msos.default_locale;cfg.culture=cfg.query.culture||store_array[1]||cfg.culture||cfg.locale;cfg.calendar=cfg.query.calendar||store_array[2]||cfg.calendar;msos.console.debug(temp_gl+" done, locale: "+cfg.locale+", culture: "+cfg.culture+", calendar: "+cfg.calendar);};msos.set_locale_storage=function(){var temp_sl="msos.set_locale_storage -> ",store_obj=msos.config.storage.site_i18n;msos.console.debug(temp_sl+"start.");store_obj.value=msos.config.locale+":"+msos.config.culture+":"+msos.config.calendar;msos.basil.set(store_obj.name,store_obj.value);msos.console.debug(temp_sl+"done, value: "+store_obj.value);store_obj.set=true;};msos.get_viewport=function(for_win){var port=msos.verge.viewport();if(window===for_win){msos.config.view_port=port;}msos.console.debug("msos.get_viewport -> viewport:",port);return port;};msos.browser_orientation=function(){var orient_ref=msos.config.view_orientation,v_port_ref=msos.get_viewport(window),temp_txt="msos.browser_orientation -> ";if(window.orientation!==undefined){switch(window.orientation){case 0:orient_ref.layout="portrait";orient_ref.direction="normal";orient_ref.numeric=0;break;case -90:orient_ref.layout="landscape";orient_ref.direction="right";orient_ref.numeric=-90;break;case 90:orient_ref.layout="landscape";orient_ref.direction="left";orient_ref.numeric=90;break;case 180:orient_ref.layout="portrait";orient_ref.direction="flipped";orient_ref.numeric=180;break;default:orient_ref.layout=v_port_ref.width/v_port_ref.height<1.1?"portrait":"landscape";orient_ref.direction="normal";orient_ref.numeric=v_port_ref.width/v_port_ref.height<1.1?0:90;}orient_ref.method="window.orientation("+window.orientation+")";}else{orient_ref.layout=v_port_ref.width/v_port_ref.height<1.1?"portrait":"landscape";orient_ref.direction="normal";orient_ref.method="document.documentElement";orient_ref.numeric=v_port_ref.width/v_port_ref.height<1.1?0:90;}msos.console.debug(temp_txt+"layout: "+orient_ref.layout+", dir: "+orient_ref.direction+" for "+orient_ref.method);return orient_ref;};msos.browser_ok=function(){var temp_txt="msos.browser_ok -> ",failed=[];if(!window.focus){failed.push("window.focus");}if(!document.images){failed.push("document.images");}if(!document.styleSheets){failed.push("document.styleSheets");}if(!document.open){failed.push("document.open");}if(!document.close){failed.push("document.close");}if(!window.document.write){failed.push("document.write");}if(!document.addEventListener){failed.push("document.addEventListener");}if(failed.length===0){msos.console.debug(temp_txt+"browser is ok");msos.config.browser.ok=true;return;}msos.console.error(temp_txt+"browser failed, does not support: "+failed.join(", "));msos.config.browser.ok=false;};msos.browser_current=function(){var temp_txt="msos.browser_current -> ",failed=[];if(!Array.prototype.indexOf){failed.push("Array.indexOf");}if(!Array.prototype.forEach){failed.push("Array.forEach");}if(!String.prototype.indexOf){failed.push("String.indexOf");}if(!String.prototype.trim){failed.push("String.trim");}if(!Function.prototype.bind){failed.push("Function.bind");}if(!Object.keys){failed.push("Object.keys");}if(!Object.create){failed.push("Object.create");}if(!JSON||!JSON.stringify||!JSON.stringify.length||JSON.stringify.length<3){failed.push("JSON.stringify");}if(failed.length===0){msos.console.debug(temp_txt+"browser is current");msos.config.browser.current=true;return;}msos.console.warn(temp_txt+"browser does not support: "+failed.join(", ")+" -> for doctype "+msos.config.doctype);if(msos.config.doctype==="xhtml5"&&failed[2]==="document.write"){msos.config.browser.current=true;return;}msos.console.error(temp_txt+"browser is not current");msos.config.browser.current=false;};msos.browser_touch=function(){var temp_tch="msos.browser_touch -> ",test="",test_div=document.createElement("div"),touch_avail=0;for(test in msos.config.touch){if(msos.config.touch.hasOwnProperty(test)){if(msos.config.touch[test]===true){touch_avail+=1;}else{touch_avail-=1;}}}try{document.createEvent("TouchEvent");touch_avail+=1;}catch(e){touch_avail-=1;}if("ontouchstart" in test_div){touch_avail+=1;}else{test_div.setAttribute("ontouchstart","return;");touch_avail+=(typeof test_div.ontouchstart==="function")?1:-1;}test_div=null;if(touch_avail>0){msos.config.browser.touch=true;}if(Modernizr.touchevents!==msos.config.browser.touch){msos.console.warn(temp_tch+"Modernizr.touchevents returned: "+Modernizr.touchevents);}msos.console.debug(temp_tch+"touch is "+(msos.config.browser.touch?"":"not")+" available, ref. ("+String(touch_avail)+")");};msos.browser_mobile=function(){var temp_mbl="msos.browser_mobile -> ",device="",scrn_px=0,flag=[];if(!msos.var_is_empty(screen.height)&&!msos.var_is_empty(screen.width)){scrn_px=(screen.height>screen.width)?screen.height:screen.width;}if(scrn_px&&scrn_px<481){flag.push("screen");}if(msos.config.browser.touch){flag.push("touch");}if(msos.config.orientation){flag.push("orientation");}if(msos.config.orientation_change){flag.push("orientation_change");}if(msos.config.pixel_ratio>1){flag.push("pixel_ratio");}if(Modernizr.devicemotion){flag.push("device_motion");}if(Modernizr.deviceorientation){flag.push("device_orientation");}if(Modernizr.overflowscrolling){flag.push("overflow_scrolling");}if(flag.length>3){msos.config.browser.mobile=true;msos.config.mobile=true;}msos.console.debug(temp_mbl+"browser is "+(msos.config.browser.mobile?"mobile":"not mobile")+(flag.length>0?", flag(s): "+flag.join(", "):""));if(msos.config.query.mobile===true||msos.config.query.mobile===false){if(msos.config.browser.mobile!==msos.config.query.mobile){msos.console.debug(temp_mbl+"force mobile setting: "+msos.config.query.mobile);}msos.config.mobile=msos.config.query.mobile?true:false;}};msos.browser_advanced=function(){var temp_txt="msos.browser_advanced -> ",M=Modernizr,failed=[];if(!M.cssgradients){failed.push("cssgradients");}if(!M.boxshadow){failed.push("boxshadow");}if(!M.csstransitions){failed.push("csstransitions");}if(!M.csstransforms){failed.push("csstransforms");}if(!M.cssanimations){failed.push("cssanimations");}if(!M.websockets){failed.push("websockets");}if(!M.localstorage){failed.push("localstorage");}if(!M.dataset){failed.push("dataset");}if(!msos.config.scrolltop){failed.push("scrollTop");}if(failed[0]){msos.console.debug(temp_txt+"browser is not advanced, missing: "+failed.join(" "));msos.config.browser.advanced=false;return false;}msos.console.debug(temp_txt+"browser is advanced.");msos.config.browser.advanced=true;return true;};msos.browser_editable=function(){if(!(document.designMode||msos.body.contentEditable)){msos.config.browser.editable=false;return;}if(document.execCommand===undefined){msos.config.browser.editable=false;return;}msos.console.debug("msos.browser_editable -> browser supports content editing");msos.config.browser.editable=true;};msos.browser_direction=function(){var browser_dir="",build_test=null;build_test=function(){var container=document.createElement("p"),span=document.createElement("span"),direction="";container.style.margin="0 0 0 0";container.style.padding="0 0 0 0";container.style.textAlign="";span.innerHTML="X";container.appendChild(span);document.body.appendChild(container);direction=span.offsetLeft<(container.offsetWidth-(span.offsetLeft+span.offsetWidth))?"ltr":"rtl";msos.body.removeChild(container);if(msos.config.verbose){msos.console.debug("msos.browser_direction -> by build_test: "+direction);}return direction;};browser_dir=(msos.body.dir||document.documentElement.dir||build_test()||"ltr").toLowerCase();msos.config.browser.direction=browser_dir;};msos.browser_preloading=function(){var script_pre=msos.config.script_preload,script_elm=document.createElement("script"),dua=navigator.userAgent;script_pre.async="async" in script_elm?true:false;script_pre.defer="defer" in script_elm?true:false;script_pre.explicit=typeof script_elm.preload==="boolean"?true:false;script_pre.available=script_pre.explicit?true:(script_elm.readyState&&script_elm.readyState==="uninitialized")?true:false;script_pre.ordered=(!script_pre.available&&script_elm.async===true)?true:false;script_pre.xhr_cache=(script_pre.available||(!script_pre.ordered&&!(dua.indexOf("Opera")!==-1)&&!(dua.indexOf("Gecko")!==-1)))?true:false;script_elm=null;};msos.browser_native_overflow=function(){var conf=msos.config;conf.browser.nativeoverflow=Modernizr.overflowscrolling||conf.overflow_scrolling.webkitoverflowscrolling||conf.overflow_scrolling.msoverflowstyle;};msos.browser_has_fastclick=function(){var chromeVersion=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],firefoxVersion=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],isblackberry10=navigator.userAgent.indexOf("BB10")>0,blackberryVersion,output=false;if(window.ontouchstart===undefined){output=true;}else{if(chromeVersion){if(navigator.userAgent.indexOf("Android")>0){if(msos.config.browser.scalable){output=true;}}else{output=true;}}else{if(isblackberry10){blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(blackberryVersion[1]>=10&&blackberryVersion[2]>=3){if(msos.config.browser.scalable){output=true;}}}else{if(firefoxVersion>=27){if(msos.config.browser.scalable){output=true;}}else{if(document.body.style.touchAction==="none"||document.body.style.touchAction==="manipulation"){output=true;}}}}}msos.config.browser.fastclick=output;};msos.browser_is_scalable=function(){var metaViewport=document.querySelector("meta[name=viewport]");if((metaViewport&&metaViewport.content.indexOf("user-scalable=no")!==-1)||(document.documentElement.scrollWidth<=window.outerWidth)){msos.config.browser.scalable=true;}};msos.get_head=function(win){var d=win.document,de=d.documentElement,hd=d.head||d.getElementsByTagName("head")[0];if(!hd){hd=d.createElement("head");de.insertBefore(hd,de.firstChild);}return hd;};msos.create_node=function(tag,atts_obj,win){if(!win){win=window;}var elem=win.document.createElement(tag),at="";if(msos.config.verbose){msos.console.debug("msos.create_node -> called for:\n     "+tag,atts_obj);}for(at in atts_obj){if(atts_obj.hasOwnProperty(at)){elem.setAttribute(at,atts_obj[at]);}}return elem;};msos.loader=function(win){var temp_mod="msos.loader",ld_obj=this,file=msos.purl().attr("file"),i=0;if(!win){win=window;}if(!win.msos){win.msos={};}if(!win.name){win.name=file.replace(/[^0-9a-zA-Z]/g,"_")||"base_win";}if(!win.msos.registered_files){win.msos.registered_files={js:{},css:{},ico:{},ajax:{}};}msos.console.debug(temp_mod+" -> start for window: "+win.name);this.doc_head=msos.get_head(win);this.toggle_css=[];this.delay_css=0;this.deferred_array=[];this.deferred_done=true;this.add_resource_onload=[];this.load=function(url,type,attribs){var name=msos.generate_url_name(url),base=url.split("?")[0],ext=base.substr(base.lastIndexOf(".")+1),pattern=/^js|css|ico$/,lo=" - load -> ",load_resource_func=null;if(msos.config.verbose){msos.console.debug(temp_mod+lo+"start.");}attribs=attribs||{};if(!type){type=ext||"na";}if(!pattern.test(type)){msos.console.error(temp_mod+lo+"missing or invalid: "+type);return;}if(ld_obj.check(name,url,type)){msos.console.debug(temp_mod+lo+"already loaded: "+name+", url: "+url);}else{load_resource_func=function(){ld_obj.resource(name,url,type,attribs);msos.pending_file_loads.push(name);};if(attribs.defer&&attribs.defer==="defer"){if(msos.config.script_preload.ordered){load_resource_func();msos.console.debug(temp_mod+lo+"browser deferred file: "+url);}else{if(ld_obj.deferred_done===true){ld_obj.deferred_done=false;load_resource_func();}else{ld_obj.deferred_array.push(load_resource_func);}msos.console.debug(temp_mod+lo+"deferred file: "+url+", queue: "+ld_obj.deferred_array.length);}}else{if(type==="css"){setTimeout(load_resource_func,ld_obj.delay_css);ld_obj.delay_css+=5;msos.console.debug(temp_mod+lo+"css file: "+url+", delay: "+ld_obj.delay_css);}else{load_resource_func();msos.console.debug(temp_mod+lo+"file: "+url);}}}if(msos.config.verbose){msos.console.debug(temp_mod+lo+"done!");}};this.check=function(file_name,file_url,file_type){var toggle=ld_obj.toggle_css,flag_loaded=false,ld=" - check -> ";msos.console.debug(temp_mod+ld+"start.");if(win.msos.registered_files[file_type]&&win.msos.registered_files[file_type][file_name]){flag_loaded=true;}if(file_type==="css"&&toggle.length>0){for(i=0;i<toggle.length;i+=1){if(win.msos.registered_files.css[toggle[i]]){win.msos.registered_files.css[toggle[i]].disabled=true;}}if(win.msos.registered_files.css[file_name]){win.msos.registered_files.css[file_name].disabled=false;msos.console.debug(temp_mod+ld+"set active: "+file_url);}for(i=0;i<ld_obj.add_resource_onload.length;i+=1){ld_obj.add_resource_onload[i]();}}msos.console.debug(temp_mod+ld+"done, already loaded (t/f): "+(flag_loaded?"true":"false")+" for "+file_name);return flag_loaded;};this.init_create_node=function(name,url,type,attribs){var node=null,icn=" - init_create_node -> ",node_attrs={},ats="";if(msos.config.verbose){msos.console.debug(temp_mod+icn+"start.");}if(msos.config.cache===false){url+=((/\?.*$/.test(url)?"&_":"?_")+~~(Math.random()*1000000000)+"=");}if(type==="js"){node_attrs={id:name,src:url};}else{if(type==="css"){node_attrs={id:name,rel:"stylesheet",href:url,media:"all"};}else{if(type==="ico"){node_attrs={id:name,type:"image/x-icon",rel:"shortcut icon",href:url};}}}if(attribs!==undefined&&typeof attribs==="object"){for(ats in attribs){if(attribs.hasOwnProperty(ats)){node_attrs[ats]=attribs[ats];}}}if(type==="js"){node=msos.create_node("script",node_attrs,win);if(attribs.defer==="defer"){node.async=false;}else{node.async=true;}}else{if(type==="css"){node=msos.create_node("link",node_attrs,win);}else{if(type==="ico"){node=msos.create_node("link",node_attrs,win);}}}node.msos_load_state="loading";if(type==="js"&&msos.config.script_onerror){node.onerror=function(e){msos.console.error(temp_mod+" -> failed for: "+name,e);};}if(msos.config.verbose){msos.console.debug(temp_mod+icn+"done!");}return node;};this.resource=function(file_name,file_url,file_type,file_atts){var node=ld_obj.init_create_node(file_name,file_url,file_type,file_atts)||null,ls=" - resource -> ",on_resource_load=function(){var i=0,pending_idx,pending_file=msos.pending_file_loads,shifted;if(this.msos_load_state!=="loaded"&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"||this.readyState==="uninitialized")){this.msos_load_state="loaded";pending_idx=_.indexOf(pending_file,this.id);if(pending_idx>=0){pending_file.splice(pending_idx,1);if(msos.config.verbose){msos.console.debug(temp_mod+ls+"loaded, name: "+this.id+", pending file count:",pending_file.length);}}else{msos.console.error(temp_mod+ls+"unknown pending file, name: "+this.id,pending_file);}for(i=0;i<ld_obj.add_resource_onload.length;i+=1){ld_obj.add_resource_onload[i]();}if(this.getAttribute("defer")==="defer"){if(ld_obj.deferred_array.length){shifted=ld_obj.deferred_array.shift();shifted();}else{ld_obj.deferred_done=true;}}this.onload=this.onreadystatechange=null;}return true;};msos.console.debug(temp_mod+ls+"start, type: "+file_type+", name: "+file_name);if(node!==null){node.onload=node.onreadystatechange=on_resource_load;ld_obj.doc_head.appendChild(node);win.msos.registered_files[file_type][file_name]=node;msos.console.debug(temp_mod+ls+"done!");}};msos.console.debug(temp_mod+" -> done!");};msos.set_environment=function(){var set_txt="msos.set_environment -> ",st_obj=msos.config.storage;msos.console.debug(set_txt+"start");st_obj.site_pref.value=msos.basil.get(st_obj.site_pref.name);st_obj.site_i18n.value=msos.basil.get(st_obj.site_i18n.name);st_obj.site_bdwd.value=msos.basil.get(st_obj.site_bdwd.name);msos.browser_ok();msos.browser_current();msos.browser_advanced();msos.browser_editable();msos.browser_orientation();msos.browser_touch();msos.browser_mobile();msos.browser_preloading();msos.browser_native_overflow();msos.browser_is_scalable();msos.browser_has_fastclick();if(msos.config.verbose){msos.console.debug(set_txt+"done, browser env: ",msos.config.browser);}else{msos.console.debug(set_txt+"done!");}};msos.calc_display_size=function(){var view="",view_size=msos.config.view_port,view_width=0,scrn_width=0,scrn_px=0,size="",adj_width=0;if(!msos.var_is_empty(view_size.width)&&view_size.width!==0){view_width=view_size.width;}if(!msos.var_is_empty(screen.width)&&screen.width!==0){scrn_width=screen.width;}scrn_px=view_width||scrn_width;for(size in msos.config.size_wide){if(msos.config.size_wide.hasOwnProperty(size)){adj_width=msos.config.size_wide[size]+(msos.config.size_wide[size]*0.01);if(scrn_px>adj_width){if(view){if(msos.config.size_wide[view]<msos.config.size_wide[size]){view=size;}}else{view=size;}}}}msos.console.debug("msos.calc_display_size -> calculated: "+view+", viewport w: "+view_size.width+", screen w: "+screen.width);return view;};msos.get_display_size=function(resize){var temp_dis="msos.get_display_size -> ",store_value=msos.config.storage.site_pref.value,browser_layout=msos.config.view_orientation.layout,store_array=[],display_size="";msos.console.debug(temp_dis+"start, resize: "+(resize?"true":"false"));if(store_value){store_array=store_value.split(":");if(browser_layout==="portrait"){display_size=store_array[0]||"";}else{display_size=store_array[1]||"";}msos.console.debug(temp_dis+"stored value detected: "+store_value);}else{store_array[0]="unknown";store_array[1]="unknown";}store_array[2]=browser_layout;if(display_size==="unknown"||resize){display_size="";}msos.config.size=msos.config.query.size||display_size||msos.calc_display_size();if(msos.config.query.size){msos.console.info(temp_dis+"NOTE: size set by input!");}if(browser_layout==="portrait"){store_array[0]=msos.config.size;}else{store_array[1]=msos.config.size;}store_value=store_array.join(":");msos.config.storage.site_pref.value=store_value;msos.console.debug(temp_dis+"done: "+msos.config.size+", for "+browser_layout);};msos.css_loader=function(url_array,win){var temp_cl="msos.css_loader -> ",loader_obj=null,css_url="",i=0;msos.console.debug(temp_cl+"start.");loader_obj=new msos.loader(win);for(i=0;i<url_array.length;i+=1){css_url=url_array[i];loader_obj.load(css_url,"css");}msos.console.debug(temp_cl+"done!");};msos.script_loader=function(url_array){var temp_esl="msos.script_loader -> ",loader_obj=null,script_url="",i=0;msos.console.debug(temp_esl+"start.");loader_obj=new msos.loader();for(i=0;i<url_array.length;i+=1){script_url=url_array[i];loader_obj.load(script_url,"js",{defer:"defer"});}msos.console.debug(temp_esl+"done!");};msos.set_environment();msos.set_locale();msos.get_display_size();msos.console.info("msos/base -> done!");msos.console.timeEnd("base");