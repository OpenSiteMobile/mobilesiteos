var hello=function(e){return msos.console.debug("hello -> called for: "+e),hello.use(e)};hello.settings={redirect_uri:msos.config.hellojs_redirect,response_type:"token",display:"popup",state:"",oauth_proxy:msos.config.oauth2.proxy_url,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:!0,page_uri:window.location.href},hello.utils={ut_name:"hello.utils",domInstance:function(e,t){var n="HTML"+(e||"").replace(/^[a-z]/,function(e){return e.toUpperCase()})+"Element";return t?window[n]?t instanceof window[n]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e:!1},clone:function(e){var t,n={};if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(_.isArray(e))return e.map(this.clone.bind(this));for(t in e)e.hasOwnProperty(t)&&(n[t]=this.clone(e[t]));return n},error:function(e,t){"use strict";return{error:{code:e,message:t}}},error_db:function(e,t){"use strict";var n=this;return msos.console.error(n.ut_name+".error -> "+e+": "+t),{error:{code:e,message:t}}},request_cors:function(e){"use strict";return"withCredentials"in new XMLHttpRequest&&e()},request:function(e,t){"use strict";function n(e,t){var n,o;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(n=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(_.extend(e.query,e.data),e.data=null),o=i.qs(e.url,e.query),e.proxy&&(o=i.qs(e.oauth_proxy,{path:o,access_token:n||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:!0})),msos.console.debug(i.ut_name+".request - formatUrl -> called, path:",o),t(o)}var o,s,r,i=this;if(msos.console.debug(this.ut_name+".request -> start, p:",e),_.isEmpty(e.data)||"FileList"in window||!i.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1),o=i.request_cors(function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))}))return n(e,function(n){var o=i.xhr(e.method,n,e.headers,e.data,t);o.onprogress=e.onprogress||null,o.upload&&e.onuploadprogress&&(o.upload.onprogress=e.onuploadprogress)}),void msos.console.debug(this.ut_name+".request -> done, for cors.");if(s=e.query,e.query=i.clone(e.query),e.callbackID=i.globalEvent(),e.jsonp!==!1){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return n(e,function(n){i.jsonp(n,t,e.callbackID,e.timeout)}),void msos.console.debug(this.ut_name+".request -> done, for get request.");e.query=s}return e.form!==!1&&(e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID}),"function"==typeof e.form&&(r=e.form(e,e.query)),"post"===e.method&&r!==!1)?(n(e,function(n){i.post(n,e.data,r,t,e.callbackID,e.timeout)}),void msos.console.debug(this.ut_name+".request -> done, for form post.")):void t(i.error("invalid_request","hello.utils.request -> no mechanism for handling this request"))},xhr:function(e,t,n,o,s){"use strict";function r(e){for(var t,n={},o=/([a-z\-]+):\s?(.*);?/gi;t=o.exec(e);)n[t[1]]=t[2];return n}var i,a,l=new XMLHttpRequest,u=!1;if(msos.console.debug("hello.utils.xhr -> start."),"blob"===e&&(u=e,e="GET"),e=e.toUpperCase(),l.onload=function(){var t,n=l.response;try{n=JSON.parse(l.responseText)}catch(o){401===l.status&&(n=utils.error_db("access_denied",l.statusText))}t=r(l.getAllResponseHeaders()),t.statusCode=l.status,s(n||("GET"===e?utils.error("empty_response","hello.utils.xhr -> could not get resource"):{}),t)},l.onerror=function(){var e=l.responseText;try{e=JSON.parse(l.responseText)}catch(t){utils.error_db("onerror_parse","hello.utils.xhr -> problem parsing r.responseText")}s(e||utils.error("access_denied","hello.utils.xhr -> could not get resource"))},"GET"===e||"DELETE"===e)o=null;else if(o&&"string"!=typeof o&&!(o instanceof FormData)&&!(o instanceof File)&&!(o instanceof Blob)){a=new FormData;for(i in o)o.hasOwnProperty(i)&&(o[i]instanceof HTMLInputElement?"files"in o[i]&&o[i].files.length>0&&a.append(i,o[i].files[0]):o[i]instanceof Blob?a.append(i,o[i],o.name):a.append(i,o[i]));o=a}if(l.open(e,t,!0),u&&("responseType"in l?l.responseType=u:l.overrideMimeType("text/plain; charset=x-user-defined")),n)for(i in n)n.hasOwnProperty(i)&&l.setRequestHeader(i,n[i]);return l.send(o),msos.console.debug("hello.utils.xhr -> done, r:",l),l},url:function(e){"use strict";var t;return e?window.URL&&URL instanceof Function&&0!==URL.length?new URL(e,window.location):(t=document.createElement("a"),t.href=e,t.cloneNode(!1)):window.location},diffKey:function(e,t){"use strict";var n,o={};if(e||!t){for(n in e)e.hasOwnProperty(n)&&(n in t||(o[n]=e[n]));return o}return e},qs:function(e,t,n){"use strict";var o,s,r,i="",a=msos.config.verbose;if(a&&msos.console.debug(this.ut_name+".qs -> start, url: "+e),t){n=n||encodeURIComponent;for(o in t)t.hasOwnProperty(o)&&(s="([\\?\\&])"+o+"=[^\\&]*",r=new RegExp(s),e.match(r)&&(e=e.replace(r,"$1"+o+"="+n(t[o])),delete t[o]))}return _.isEmpty(t)?(a&&msos.console.debug(this.ut_name+".qs ->  done, url: "+e),e):(i=e+(e.indexOf("?")>-1?"&":"?")+this.param(t,n),a&&msos.console.debug(this.ut_name+".qs ->  done (empty params), url: "+i),i)},jsonp:function(e,t,n,o){"use strict";var s,r=this,i=0,a=document.getElementsByTagName("head")[0],l=function(){i||(i+=1,setTimeout(function(){t(r.error("server_error","hello.utils.jsonp - cb -> server error for ID: "+n)),a.removeChild(s)},0))};msos.config.verbose&&msos.console.debug(this.ut_name+".jsonp -> start, url: "+e+", callbackID:",n),n=r.globalEvent(function(e){return result=e,!0},n),e=e.replace(new RegExp("=\\?(&|$)"),"="+n+"$1"),s=r.append("script",{id:n,name:n,src:e,async:!0,onload:l,onerror:l,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&l()}}),o&&setTimeout(function(){result=r.error("timeout","hello.utils.jsonp -> timeout"),l()},o),msos.config.verbose&&msos.console.debug(this.ut_name+".jsonp -> done, callbackID:",n),a.appendChild(s)},post:function(e,t,n,o,s,r){"use strict";var i,a,l,u,c=this,d=null,f=[],p=document.body,h=0,m=null,g=0,b=function(e){g||(g+=1,o(e))},y=document.createElement("iframe");if(msos.console.debug(this.ut_name+".post -> start, url: "+e+", callbackID: "+s+", data:",t),y.name=s,y.id=s,y.style.display="none",c.globalEvent(b,s),n&&n.callbackonload&&(y.onload=function(){b({response:"posted",message:"Content was posted"})}),r&&setTimeout(function(){b(c.error("timeout","hello.utils.post -> operation timed out"))},r),p.appendChild(y),c.domInstance("form",t)){for(d=t.form,h=0;h<d.elements.length;h+=1)d.elements[h]!==t&&d.elements[h].setAttribute("disabled",!0);t=d}if(c.domInstance("form",t))for(d=t,h=0;h<d.elements.length;h+=1)d.elements[h].disabled||"file"!==d.elements[h].type||(d.encoding=d.enctype="multipart/form-data",d.elements[h].setAttribute("name","file"));else{for(m in t)t.hasOwnProperty(m)&&c.domInstance("input",t[m])&&"file"===t[m].type&&(d=t[m].form,d.encoding=d.enctype="multipart/form-data");d||(d=document.createElement("form"),p.appendChild(d),i=d);for(m in t)if(t.hasOwnProperty(m))if(l=c.domInstance("input",t[m])||c.domInstance("textArea",t[m])||c.domInstance("select",t[m]),l&&t[m].form===d)l&&t[m].name!==m&&(t[m].setAttribute("name",m),t[m].name=m);else{if(u=d.elements[m],a)for(u instanceof NodeList||(u=[u]),h=0;h<u.length;h++)u[h].parentNode.removeChild(u[h]);a=document.createElement("input"),a.setAttribute("type","hidden"),a.setAttribute("name",m),l?a.value=t[m].value:c.domInstance(null,t[m])?a.value=t[m].innerHTML||t[m].innerText:a.value=t[m],d.appendChild(a)}for(h=0;h<d.elements.length;h+=1)a=d.elements[h],a.name in t||a.getAttribute("disabled")===!0||(a.setAttribute("disabled",!0),f.push(a))}d.setAttribute("method","POST"),d.setAttribute("target",s),d.setAttribute("action",e),setTimeout(function(){d.submit(),setTimeout(function(){var e=0;try{i&&p.removeChild(i)}catch(t){c.error_db("remove_form",t.message)}for(e=0;e<f.length;e+=1)f[e]&&(f[e].setAttribute("disabled",!1),f[e].disabled=!1)},10)},100),msos.console.debug(this.ut_name+".post ->  done!")},param:function(e,t){"use strict";var n,o,s,r,i={},a=[],l=0,u="";if(msos.config.verbose&&msos.console.debug(this.ut_name+".param -> start, for:",e),"string"==typeof e){if(t=t||decodeURIComponent,o=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(l=0;l<o.length;l+=1)n=o[l].match(/([^=]+)=(.*)/),i[n[1]]=t(n[2]);return msos.config.verbose&&msos.console.debug(this.ut_name+".param -> done, object:",i),i}if(t=t||encodeURIComponent,s=e,_.isObject(s)){for(r in s)s.hasOwnProperty(r)&&a.push([r,"?"===s[r]?"?":t(s[r])].join("="));u=a.join("&")}return msos.config.verbose&&msos.console.debug(this.ut_name+".param -> done, string: "+u),u},store:function(e,t){"use strict";var n=JSON.parse(msos.basil.get("hello"))||{};if(e&&void 0===t)return msos.console.debug("hello.utils.store - get -> name: "+e+", value: "+n[e]),n[e]||null;if(e&&null===t)try{delete n[e]}catch(o){n[e]=null}else{if(!e)return n;msos.console.debug("hello.utils.store - set -> name: "+e+", value: "+t),n[e]=t}return msos.basil.set("hello",JSON.stringify(n)),n||null},append:function(e,t,n){"use strict";var o,s,r="string"==typeof e?document.createElement(e):e,i="";if(msos.console.debug(this.ut_name+".append -> start."),"object"==typeof t)if(t.tagName)n=t;else for(o in t)if(t.hasOwnProperty(o))if("object"==typeof t[o])for(s in t[o])t[o].hasOwnProperty(s)&&(r[o][s]=t[o][s]);else"html"===o?r.innerHTML=t[o]:/^on/.test(o)?r[o]=t[o]:r.setAttribute(o,t[o]);return"body"===n?(i="body",function a(){document.body?document.body.appendChild(r):setTimeout(a,16)}()):"object"==typeof n?(i="dom object",n.appendChild(r)):"string"==typeof n?(i=n,document.getElementsByTagName(n)[0].appendChild(r)):i="no target",msos.console.debug(this.ut_name+".append -> done, target: "+i),r},merge:function(){"use strict";var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},extend:function(e){"use strict";return Array.prototype.slice.call(arguments,1).forEach(function(t){var n;if(_.isArray(e)&&_.isArray(t))Array.prototype.push.apply(e,t);else if(e&&(e instanceof Object||"object"==typeof e)&&t&&(t instanceof Object||"object"==typeof t)&&e!==t)for(n in t)t.hasOwnProperty(n)&&(e[n]=hello.utils.extend(e[n],t[n]));else _.isArray(t)&&(t=t.slice(0)),e=t}),e},args:function(e,t){"use strict";var n={},o=0,s=null,r=null;for(r in e)if(e.hasOwnProperty(r))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[r])for(r in t[0])if(e.hasOwnProperty(r)&&r in e)return t[0];for(r in e)if(e.hasOwnProperty(r))if(s=typeof t[o],"function"==typeof e[r]&&e[r].test(t[o])||"string"==typeof e[r]&&(e[r].indexOf("s")>-1&&"string"===s||e[r].indexOf("o")>-1&&"object"===s||e[r].indexOf("i")>-1&&"number"===s||e[r].indexOf("a")>-1&&"object"===s||e[r].indexOf("f")>-1&&"function"===s))n[r]=t[o++];else if("string"==typeof e[r]&&e[r].indexOf("!")>-1)return!1;return n},Promise:function(){var e=0,t=1,n=2,o=function(t){return this instanceof o?(this.id="Thenable/1.0.6",this.state=e,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},void("function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this)))):new o(t)};o.prototype={fulfill:function(e){return s(this,t,"fulfillValue",e)},reject:function(e){return s(this,n,"rejectReason",e)},then:function(e,t){var n=this,s=new o;return n.onFulfilled.push(a(e,s,"fulfill")),n.onRejected.push(a(t,s,"reject")),r(n),s.proxy}};var s=function(t,n,o,s){return t.state===e&&(t.state=n,t[o]=s,r(t)),t},r=function(e){e.state===t?i(e,"onFulfilled",e.fulfillValue):e.state===n&&i(e,"onRejected",e.rejectReason)},i=function(e,t,n){if(0!==e[t].length){var o=e[t];e[t]=[];var s=function(){for(var e=0;e<o.length;e++)o[e](n)};"object"==typeof process&&"function"==typeof process.nextTick?process.nextTick(s):"function"==typeof setImmediate?setImmediate(s):setTimeout(s,0)}},a=function(e,t,n){return function(o){if("function"!=typeof e)t[n].call(t,o);else{var s;try{s=e(o)}catch(r){return void t.reject(r)}l(t,s)}}},l=function(e,t){if(e===t||e.proxy===t)return void e.reject(new TypeError("cannot resolve promise with itself"));var n;if("object"==typeof t&&null!==t||"function"==typeof t)try{n=t.then}catch(o){return void e.reject(o)}if("function"!=typeof n)e.fulfill(t);else{var s=!1;try{n.call(t,function(n){s||(s=!0,n===t?e.reject(new TypeError("circular thenable chain")):l(e,n))},function(t){s||(s=!0,e.reject(t))})}catch(o){s||e.reject(o)}}};return o}(),Event:function(){"use strict";var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,n){if(n&&"function"==typeof n){var o=t.split(e),s=0;for(s=0;s<o.length;s+=1)this.events[o[s]]=[n].concat(this.events[o[s]]||[])}return this},this.off=function(e,t){return this.findEvents(e,function(e,n){t&&this.events[e][n]!==t||(this.events[e][n]=null)}),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=this,o=function(n,o){t[t.length-1]="*"===n?e:n,this.events[n][o].apply(this,t)};for(t.push(e);n&&n.findEvents;)n.findEvents(e+",*",o),n=n.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout(function(){e.emit.apply(e,t)},10),this},this.findEvents=function(t,n){var o,s=t.split(e),r=0;for(o in this.events)if(this.events.hasOwnProperty(o)&&_.indexOf(s,o)>-1)for(r=0;r<this.events[o].length;r+=1)this.events[o][r]&&n.call(this,o,r)},this},globalEvent:function(e,t){"use strict";return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),msos.console.debug(this.ut_name+".globalEvent -> start, guid: "+t),window[t]=function(){var n=e.apply(this,arguments);if(msos.console.debug(t+" ~~~> start."),n)try{delete window[t],msos.console.debug(t+" ~~~> delete: "+t)}catch(o){msos.console.error(t+" ~~~> delete failed, reason: "+o.message)}msos.console.debug(t+" ~~~> done!")},msos.console.debug(this.ut_name+".globalEvent ->  done, guid: "+t),t},popup:function(e,t,n){"use strict";var o,s,r,i,a,l=document.documentElement,u=[];return n.height&&(o=void 0!==window.screenTop?window.screenTop:screen.top,r=screen.height||window.innerHeight||l.clientHeight,n.top=parseInt((r-n.height)/2,10)+o),n.width&&(s=void 0!==window.screenLeft?window.screenLeft:screen.left,i=screen.width||window.innerWidth||l.clientWidth,n.left=parseInt((i-n.width)/2,10)+s),Object.keys(n).forEach(function(e){var t=n[e];u.push(e+(null!==t?"="+t:""))}),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e))),a=window.open(e,"_blank",u.join(",")),a&&a.focus&&a.focus(),a},hasBinary:function(e){var t;for(t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t,n=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,o=e.match(n),s=[],r=0;if(!o)return e;for(t=atob(e.replace(n,"")),r=0;r<t.length;r+=1)s.push(t.charCodeAt(r));return new Blob([new Uint8Array(s)],{type:o[1]})},dataToJSON:function(e){var t,n=this,o=window,s=e.data;if(n.domInstance("form",s)?s=n.nodeListToJSON(s.elements):"NodeList"in o&&s instanceof NodeList?s=n.nodeListToJSON(s):n.domInstance("input",s)&&(s=n.nodeListToJSON([s])),("File"in o&&s instanceof o.File||"Blob"in o&&s instanceof o.Blob||"FileList"in o&&s instanceof o.FileList)&&(s={file:s}),!("FormData"in o&&s instanceof o.FormData))for(t in s)if(s.hasOwnProperty(t))if("FileList"in o&&s[t]instanceof o.FileList)1===s[t].length&&(s[t]=s[t][0]);else{if(n.domInstance("input",s[t])&&"file"===s[t].type)continue;n.domInstance("input",s[t])||n.domInstance("select",s[t])||n.domInstance("textArea",s[t])?s[t]=s[t].value:n.domInstance(null,s[t])&&(s[t]=s[t].innerHTML||s[t].innerText)}return e.data=s,s},nodeListToJSON:function(e){var t,n={},o=0;for(o=0;o<e.length;o+=1)t=e[o],!t.disabled&&t.name&&("file"===t.type?n[t.name]=t:n[t.name]=t.value||t.innerHTML);return n}},hello.services={},hello.events={},hello.use=function(e){"use strict";msos.console.debug("hello.use -> start.");var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),msos.console.debug("hello.use -> done!"),t},hello.init=function(e,t){"use strict";var n=this,o=msos.config.verbose;return o&&msos.console.debug("hello.init -> start."),e?(n.services=_.extend(n.services,e),t&&(o&&msos.console.debug("hello.init -> extend setting, options:",t),n.settings=_.extend(n.settings,t),"redirect_uri"in t&&(n.settings.redirect_uri=hello.utils.url(t.redirect_uri).href)),o&&msos.console.debug("hello.init -> done, extend hello.services:",n.services),n):(msos.console.warn("hello.init -> done, return hello.services obj."),n.services)},hello.login=function(){"use strict";function e(e){return e}function t(e){return!!e}function n(e,t){hello.emit(e,t)}var o,s,r,i,a,l,u,c,d,f,p,h,m,g,b=this,y=b.utils,v=y.error,w=y.Promise(),x=/[,\s]+/;return o=y.args({network:"s",options:"o",callback:"f"},arguments),msos.console.debug("hello.login -> start, p:",o),r=y.diffKey(o.options,b.settings),i=o.options=y.merge(b.settings,o.options||{}),i.popup=y.merge(b.settings.popup,o.options.popup||{}),o.network=o.network||b.settings.default_service,w.proxy.then(o.callback,o.callback),w.proxy.then(n.bind(this,"auth.login auth"),n.bind(this,"auth.failed auth")),"string"==typeof o.network&&o.network in b.services?(a=b.services[o.network],l=y.globalEvent(function(e){var t;msos.console.debug("hello.login - cb -> start."),t=e?JSON.parse(e):v("cancelled","The authentication was not completed"),t.error?w.reject(t):(y.store(t.network,t),w.fulfill({network:t.network,authResponse:t})),msos.console.debug("hello.login - cb -> done!")}),u=y.url(i.redirect_uri).href,c=a.oauth.response_type||i.response_type,/\bcode\b/.test(c)&&!a.oauth.grant&&(c=c.replace(/\bcode\b/,"token")),o.qs=y.merge(r,{client_id:encodeURIComponent(a.id),response_type:encodeURIComponent(c),redirect_uri:encodeURIComponent(u),state:{client_id:a.id,network:o.network,display:i.display,callback:l,state:i.state,redirect_uri:u}}),d=y.store(o.network),p=b.settings.scope?[b.settings.scope.toString()]:[],msos.config.verbose&&msos.console.debug("hello.login -> session/scope:",d,p),h=y.merge(b.settings.scope_map,a.scope||{}),i.scope&&p.push(i.scope.toString()),d&&"scope"in d&&d.scope instanceof String&&p.push(d.scope),p=p.join(",").split(x),p=_.unique(p).filter(t),o.qs.state.scope=p.join(","),p=p.map(function(e){return e in h?h[e]:e}),p=p.join(",").split(x),p=_.unique(p).filter(t),o.qs.scope=p.join(a.scope_delim||","),i.force===!1&&d&&d.access_token&&d.expires&&d.expires>(new Date).getTime()/1e3&&(f=_.difference((d.scope||"").split(x),(o.qs.state.scope||"").split(x)),0===f.length)?(msos.console.debug("hello.login -> found access_token"),w.fulfill({unchanged:!0,network:o.network,authResponse:d}),w):("page"===i.display&&i.page_uri&&(o.qs.state.page_uri=y.url(i.page_uri).href),a.login&&"function"==typeof a.login&&a.login(o),(!/\btoken\b/.test(c)||parseInt(a.oauth.version,10)<2||"none"===i.display&&a.oauth.grant&&d&&d.refresh_token)&&(o.qs.state.oauth=a.oauth,o.qs.state.oauth_proxy=i.oauth_proxy),o.qs.state=encodeURIComponent(JSON.stringify(o.qs.state)),1===parseInt(a.oauth.version,10)?s=y.qs(i.oauth_proxy,o.qs,e):"none"===i.display&&a.oauth.grant&&d&&d.refresh_token?(o.qs.refresh_token=d.refresh_token,s=y.qs(i.oauth_proxy,o.qs,e)):s=y.qs(a.oauth.auth,o.qs,e),n("auth.init",o),msos.console.debug("hello.login -> display: "+i.display||"undefined"),"none"===i.display?y.iframe(s,u):"popup"===i.display?(m=y.popup(s,u,i.popup),g=setInterval(function(){var e;m&&!m.closed||(clearInterval(g),w.state||(e=v("cancelled","login has been cancelled"),m||(e=v("blocked","popup was blocked")),e.network=o.network,w.reject(e)))},100)):window.location=s,msos.console.debug("hello.login -> done!"),w.proxy)):w.reject(v("invalid_network","the provided network was not recognized"))},hello.logout=function(){"use strict";function e(e,t){hello.emit(e,t)}var t,n,o=this,s=o.utils,r=s.error,i=s.Promise(),a=s.args({name:"s",options:"o",callback:"f"},arguments),l={};if(a.options=a.options||{},msos.console.debug("hello.logout -> start, p:",a),i.proxy.then(a.callback,a.callback),i.proxy.then(e.bind(this,"auth.logout auth"),e.bind(this,"error")),a.name=a.name||this.settings.default_service,a.authResponse=s.store(a.name),!a.name||a.name in o.services)if(a.name&&a.authResponse){if(t=function(e){s.store(a.name,null),i.fulfill(hello.utils.merge({network:a.name},e||{}))},a.options.force&&(n=o.services[a.name].logout))if("function"==typeof n&&(n=n(t,a)),"string"==typeof n)s.iframe(n),l.force=null,l.message="Logout success on providers site was indeterminate";else if(void 0===n)return i.proxy;t(l)}else i.reject(r("invalid_session","there was no session to remove"));else i.reject(r("invalid_network","the network was unrecognized"));return msos.console.debug("hello.logout -> done!"),i.proxy},hello.getAuthResponse=function(e){"use strict";return msos.console.debug("hello.getAuthResponse -> start, for: "+e),e=e||this.settings.default_service,e&&e in this.services?(msos.console.debug("hello.getAuthResponse -> done!"),this.utils.store(e)||null):(msos.console.warn("hello.getAuthResponse -> done, service na"),null)},hello.utils.Event.call(hello),function(e){var t=e.api=function(){var n=e.utils.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return n.data&&e.utils.dataToJSON(n),t.call(this,n)}}(hello);