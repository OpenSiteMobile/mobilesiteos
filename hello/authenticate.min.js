(function(_1,_2){"use strict";var _3="",_4=_1.utils,_5=_2.opener||_2.parent,_6=_2.location,p={},q={},a,_7,_8;_2.name=_2.name||"child_"+parseInt(Math.random()*1000000000000,10).toString(36);_3=_2.name+" - authenticating 8==> ";msos.console.debug(_3+"start, location: "+_6);function _9(_a,_b){var _c="auth_cb -> ",cb;msos.console.debug(_3+_c+"start.");_4.store(_b.network,_b);if(!(p.display)||p.display!=="page"){if(_5){cb=_b.callback;delete _b.callback;msos.console.debug(_3+_c+"callback: "+cb);try{_5[cb](_b);}catch(e){msos.console.error(_3+_c+"callback: "+cb+", failed: "+e.message);}_4.store(_b.network,_b);}else{msos.console.warn(_3+_c+"no parent.");}_2.close();}else{msos.console.debug(_3+_c+"skipped page.");}msos.console.debug(_3+_c+"done!");};p=_4.merge(_4.param(_6.search||""),_4.param(_6.hash||""));if(p&&p.state){try{a=JSON.parse(p.state);p=_4.merge(p,a);}catch(e){_1.emit("error",{error:{code:"decode_state",message:e.message}});}if(p.access_token&&p.network){if(!p.expires_in||parseInt(p.expires_in,10)===0){p.expires_in=0;}p.expires_in=parseInt(p.expires_in,10);p.expires=((new Date()).getTime()/1000)+(p.expires_in||(60*60*24*365));_1.service(p.network);_9(p.network,p);}else{if(p.error&&p.network){p.error={code:p.error,message:p.error_message||p.error_description};_9(p.network,p);}}if(p&&p.callback&&p.result){if(_2.parent[p.callback]){_2.parent[p.callback](JSON.parse(p.result));}}}else{msos.console.warn(_3+"no query returned.");}msos.console.debug(_3+"done, window: "+_2.name);}(hello,window));